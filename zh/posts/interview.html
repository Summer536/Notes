<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.22" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.86" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Interview","image":[""],"datePublished":"2025-08-16T00:00:00.000Z","dateModified":"2025-08-22T03:04:48.000Z","author":[{"@type":"Person","name":"GYQ","url":"https://github.com/Summer536"}]}</script><meta property="og:url" content="https://your-domain.com/Notes/zh/posts/interview.html"><meta property="og:site_name" content="GYQçš„åšå®¢"><meta property="og:title" content="Interview"><meta property="og:description" content="Interview ä¸€. C++ C++æ˜¯åŸºç¡€ï¼Œä¼šåœ¨é¢è¯•æ ¡æ‹›ç”Ÿå’Œç¤¾æ‹›ä¸¤å¹´å†…æ—¶è€ƒå¯Ÿã€‚ 1. å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ ç®¡ç†æ–¹å¼ï¼šæ ˆç”±ç¼–è¯‘å™¨ç®¡ç†ï¼Œå †ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†ï¼› ç¢ç‰‡é—®é¢˜ï¼šæ ˆä¸å­˜åœ¨ç¢ç‰‡é—®é¢˜ï¼Œå †å¾ˆå®¹æ˜“äº§ç”Ÿç¢ç‰‡ï¼› åˆ†é…æ–¹å¼ï¼šæ ˆæ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…çš„ï¼Œå †æ˜¯(new,delete/malloc,free)åˆ†é…ã€‚ åˆ†é…æ•ˆç‡ï¼šæ ˆçš„æ•ˆç‡æ¯”å †é«˜ï¼› 2. ä»¥ä¸‹å››è¡Œä»£ç ä¼šè°ƒç”¨åˆ°ä»€ä¹ˆå‡½..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-08-22T03:04:48.000Z"><meta property="article:tag" content="GPUä¼˜åŒ–"><meta property="article:published_time" content="2025-08-16T00:00:00.000Z"><meta property="article:modified_time" content="2025-08-22T03:04:48.000Z"><title>Interview | GYQçš„åšå®¢</title><meta name="description" content="Interview ä¸€. C++ C++æ˜¯åŸºç¡€ï¼Œä¼šåœ¨é¢è¯•æ ¡æ‹›ç”Ÿå’Œç¤¾æ‹›ä¸¤å¹´å†…æ—¶è€ƒå¯Ÿã€‚ 1. å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ ç®¡ç†æ–¹å¼ï¼šæ ˆç”±ç¼–è¯‘å™¨ç®¡ç†ï¼Œå †ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†ï¼› ç¢ç‰‡é—®é¢˜ï¼šæ ˆä¸å­˜åœ¨ç¢ç‰‡é—®é¢˜ï¼Œå †å¾ˆå®¹æ˜“äº§ç”Ÿç¢ç‰‡ï¼› åˆ†é…æ–¹å¼ï¼šæ ˆæ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…çš„ï¼Œå †æ˜¯(new,delete/malloc,free)åˆ†é…ã€‚ åˆ†é…æ•ˆç‡ï¼šæ ˆçš„æ•ˆç‡æ¯”å †é«˜ï¼› 2. ä»¥ä¸‹å››è¡Œä»£ç ä¼šè°ƒç”¨åˆ°ä»€ä¹ˆå‡½...">
    <link rel="stylesheet" href="/Notes/assets/css/styles.e016f07c.css">
    <link rel="preload" href="/Notes/assets/js/runtime~app.92bd03ff.js" as="script"><link rel="preload" href="/Notes/assets/css/styles.e016f07c.css" as="style"><link rel="preload" href="/Notes/assets/js/2047.24e5abc8.js" as="script"><link rel="preload" href="/Notes/assets/js/app.56c173b4.js" as="script">
    <link rel="prefetch" href="/Notes/assets/js/zh_posts_flashattention.html.b1c0b289.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_Deepseek_MLA.html.8a14a118.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_gemm.html.1fc67630.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_softmax.html.56f8f20e.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_interview.html.215cb8a1.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_parallel.html.9f5e48db.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_cpp.html.77b3d045.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_AWQ.html.10de9382.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_reduce.html.a503219c.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_pagedattention.html.b7ac47da.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_Inference.html.dff430b0.js" as="script"><link rel="prefetch" href="/Notes/assets/js/8300.0dbfd86b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_MoE.html.74ec6c39.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_DeepSpeed.html.5f448ddb.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_markdown.html.6207b366.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_Examination.html.d78aa514.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_cuda-tech-stack.html.7d4658ed.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_notes_index.html.4c2e027a.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_projects_index.html.13023d66.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_page.html.616aea09.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_about_index.html.43601c8a.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_layout.html.8dde54c6.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_interview1.html.94763f5e.js" as="script"><link rel="prefetch" href="/Notes/assets/js/index.html.3a59f567.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_interview_index.html.f0215288.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_disable.html.d71163c4.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_intro.html.28ed9b13.js" as="script"><link rel="prefetch" href="/Notes/assets/js/intro.html.a286bfb4.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_index.html.bb07931d.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_index.html.ccaee54b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/demo_encrypt.html.9afa503e.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_æ³¨æ„åŠ›æœºåˆ¶_index.html.5bbc2c4f.js" as="script"><link rel="prefetch" href="/Notes/assets/js/category_index.html.7d951c14.js" as="script"><link rel="prefetch" href="/Notes/assets/js/timeline_index.html.b6a7590c.js" as="script"><link rel="prefetch" href="/Notes/assets/js/article_index.html.053b7324.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_æ·±åº¦å­¦ä¹ _index.html.6dc4a7c3.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_æœºå™¨å­¦ä¹ _index.html.300b8748.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_å…«è‚¡é¢è¯•_index.html.f076429f.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_ç®—æ³•ä¼˜åŒ–_index.html.d7f1afe9.js" as="script"><link rel="prefetch" href="/Notes/assets/js/star_index.html.dc387182.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_index.html.e5503b63.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_å¤§æ¨¡å‹_index.html.bbd1540b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_gpuä¼˜åŒ–_index.html.69da039d.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_gpuç¼–ç¨‹_index.html.977a9f2e.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_å…«è‚¡_index.html.ecdbdcf4.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_ç¬”è®°_index.html.d24bd616.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_é¡¹ç›®_index.html.1b9ec38f.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_æŠ€æœ¯_index.html.b484df4d.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_é‡åŒ–_index.html.36f47622.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_page-config_index.html.488b723b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_encryption_index.html.2e240ad4.js" as="script"><link rel="prefetch" href="/Notes/assets/js/category_guide_index.html.8468d31f.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_cuda_index.html.67833435.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_markdown_index.html.08d65f23.js" as="script"><link rel="prefetch" href="/Notes/assets/js/404.html.b2941724.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_disable_index.html.307f1950.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_layout_index.html.6126668b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_cpp_index.html.ffb9b4d2.js" as="script"><link rel="prefetch" href="/Notes/assets/js/tag_guide_index.html.1b370312.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_timeline_index.html.d91b51e0.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_category_index.html.230e4f4c.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_article_index.html.065a6f4b.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_star_index.html.aeb41d98.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_tag_index.html.5b89155c.js" as="script"><link rel="prefetch" href="/Notes/assets/js/zh_posts_index.html.7d01c5a5.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/Notes/zh/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/Notes/public/YQ_logo1.png" alt><!----><span class="vp-site-name hide-in-pad">GYQçš„åšå®¢</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/Notes/zh/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" height="1em" sizing="height"></iconify-icon><!--]-->åšå®¢ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/Notes/zh/notes/" aria-label="å­¦ä¹ ç¬”è®°"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:folder-open" height="1em" sizing="height"></iconify-icon><!--]-->å­¦ä¹ ç¬”è®°<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/Notes/zh/projects/" aria-label="é¡¹ç›®å®è·µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:code" height="1em" sizing="height"></iconify-icon><!--]-->é¡¹ç›®å®è·µ<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é€‰æ‹©è¯­è¨€"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/Notes/" aria-label="English"><!---->English<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/Notes/zh/posts/interview.html" aria-label="ç®€ä½“ä¸­æ–‡"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/your-username/your-repo" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/" aria-label="åšå®¢ä¸»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->åšå®¢ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" width="1em" height="1em" sizing="both"></iconify-icon><a class="auto-link external-link vp-sidebar-title no-external-link-icon" href="https://github.com/Summer536/Notes" aria-label="å¦‚ä½•ä½¿ç”¨" rel="noopener noreferrer" target="_blank"><!---->å¦‚ä½•ä½¿ç”¨<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><iconify-icon class="vp-icon" icon="fa6-solid:book" width="1em" height="1em" sizing="both"></iconify-icon><span class="vp-sidebar-title">æ–‡ç« </span><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/AWQ.html" aria-label="AWQ"><!---->AWQ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/cpp.html" aria-label="CPPå…«è‚¡"><!---->CPPå…«è‚¡<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/cuda-tech-stack.html" aria-label="CUDAæŠ€æœ¯æ ˆ"><!---->CUDAæŠ€æœ¯æ ˆ<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/Deepseek_MLA.html" aria-label="Deepseek MLA"><!---->Deepseek MLA<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/DeepSpeed.html" aria-label="DeepSpeed"><!---->DeepSpeed<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/Examination.html" aria-label="Examination"><!---->Examination<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/flashattention.html" aria-label="Flashattention"><!---->Flashattention<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/gemm.html" aria-label="GEMM"><!---->GEMM<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/Inference.html" aria-label="InferenceæœåŠ¡çš„ä¸€äº›å¸¸è§é—®é¢˜"><!---->InferenceæœåŠ¡çš„ä¸€äº›å¸¸è§é—®é¢˜<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/Notes/zh/posts/interview.html" aria-label="Interview"><!---->Interview<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/MoE.html" aria-label="MoE"><!---->MoE<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/pagedattention.html" aria-label="PagedAttention"><!---->PagedAttention<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/reduce.html" aria-label="Reduce"><!---->Reduce<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/softmax.html" aria-label="Softmax"><!---->Softmax<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/interview1.html" aria-label="å…«è‚¡é¢è¯•"><!---->å…«è‚¡é¢è¯•<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/posts/parallel.html" aria-label="å¹¶è¡Œæ–¹æ³•DPã€TPã€PPã€EPã€SP"><!---->å¹¶è¡Œæ–¹æ³•DPã€TPã€PPã€EPã€SP<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/Notes/zh/intro.html" aria-label="ä»‹ç»é¡µ"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:circle-info" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->ä»‹ç»é¡µ<!----></a></li><li><a class="auto-link external-link vp-sidebar-link" href="https://ecosystem.vuejs.press/zh/plugins/markdown/revealjs/demo.html" aria-label="å¹»ç¯ç‰‡" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:person-chalkboard" width="1em" height="1em" sizing="both"></iconify-icon><!--]-->å¹»ç¯ç‰‡<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Interview</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/Summer536" target="_blank" rel="noopener noreferrer">GYQ</a></span><span property="author" content="GYQ"></span></span><span class="page-original-info">åŸåˆ›</span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/8/16</span><meta property="datePublished" content="2025-08-16T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 29 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT29M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color3 clickable" role="navigation">ç¬”è®°</span><!--]--><meta property="articleSection" content="ç¬”è®°"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color4 clickable" role="navigation">GPUä¼˜åŒ–</span><!--]--><meta property="keywords" content="GPUä¼˜åŒ–"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="interview" tabindex="-1"><a class="header-anchor" href="#interview"><span>Interview</span></a></h1><h2 id="ä¸€-c" tabindex="-1"><a class="header-anchor" href="#ä¸€-c"><span>ä¸€. C++</span></a></h2><p>C++æ˜¯åŸºç¡€ï¼Œä¼šåœ¨é¢è¯•æ ¡æ‹›ç”Ÿå’Œç¤¾æ‹›ä¸¤å¹´å†…æ—¶è€ƒå¯Ÿã€‚</p><h3 id="_1-å †å’Œæ ˆçš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_1-å †å’Œæ ˆçš„åŒºåˆ«"><span>1. å †å’Œæ ˆçš„åŒºåˆ«ï¼Ÿ</span></a></h3><ol><li>ç®¡ç†æ–¹å¼ï¼šæ ˆç”±ç¼–è¯‘å™¨ç®¡ç†ï¼Œå †ç”±ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†ï¼›</li><li>ç¢ç‰‡é—®é¢˜ï¼šæ ˆä¸å­˜åœ¨ç¢ç‰‡é—®é¢˜ï¼Œå †å¾ˆå®¹æ˜“äº§ç”Ÿç¢ç‰‡ï¼›</li><li>åˆ†é…æ–¹å¼ï¼šæ ˆæ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…çš„ï¼Œå †æ˜¯(new,delete/malloc,free)åˆ†é…ã€‚</li><li>åˆ†é…æ•ˆç‡ï¼šæ ˆçš„æ•ˆç‡æ¯”å †é«˜ï¼›</li></ol><h3 id="_2-ä»¥ä¸‹å››è¡Œä»£ç ä¼šè°ƒç”¨åˆ°ä»€ä¹ˆå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_2-ä»¥ä¸‹å››è¡Œä»£ç ä¼šè°ƒç”¨åˆ°ä»€ä¹ˆå‡½æ•°"><span>2. ä»¥ä¸‹å››è¡Œä»£ç ä¼šè°ƒç”¨åˆ°ä»€ä¹ˆå‡½æ•°ï¼Ÿ</span></a></h3><p>// Aæ˜¯ä¸€ä¸ªC++ç±»<br> A a1(1); //æ„é€ å‡½æ•°<br> A a2(2); //æ„é€ å‡½æ•°<br> a2 = a1; // æ‹·è´èµ‹å€¼ï¼Œoperator=<br> A a3 = a1; //æ‹·è´æ„é€ å‡½æ•°ï¼ˆä½¿ç”¨å·²ç»åˆå§‹åŒ–çš„å¯¹è±¡a1å»åˆå§‹åŒ–ä¸€ä¸ªæ²¡æœ‰åˆå§‹åŒ–è¿‡çš„å¯¹è±¡a3ï¼Œç¬¦åˆæ‹·è´æ„é€ å‡½æ•°å®šä¹‰ï¼‰</p><h3 id="_3-c-ç±»çš„æ‹·è´æ„é€ å‡½æ•°æœ‰å“ªå‡ ç§è°ƒç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#_3-c-ç±»çš„æ‹·è´æ„é€ å‡½æ•°æœ‰å“ªå‡ ç§è°ƒç”¨åœºæ™¯"><span>3. C++ç±»çš„æ‹·è´æ„é€ å‡½æ•°æœ‰å“ªå‡ ç§è°ƒç”¨åœºæ™¯ï¼Ÿ</span></a></h3><ol><li>å¯¹è±¡ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œä»¥å€¼ä¼ é€’çš„æ–¹å¼ä¼ å…¥å‡½æ•°ä½“ï¼›ï¼ˆæ‰©å±•ï¼Œå½“æ‹·è´æ„é€ å‡½æ•°çš„å‚æ•°ä¸æ˜¯å¼•ç”¨ç±»å‹(const MyClass&amp; other)ï¼Œè€Œæ˜¯å€¼ç±»å‹(MyClass other)çš„æ—¶å€™ï¼Œå¯èƒ½å­˜åœ¨<strong>å¾ªç¯è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°çš„æƒ…å†µï¼Œé€ æˆæ ˆæº¢å‡º</strong>ï¼‰</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">MyClass</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // obj éœ€è¦æ‹·è´æ„é€ </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">MyClass a;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(a);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>å¯¹è±¡ä½œä¸ºå‡½æ•°è¿”å›å€¼ï¼Œä»¥å€¼ä¼ é€’çš„æ–¹å¼ä»å‡½æ•°è¿”å›ï¼›ï¼ˆæ‰©å±•ï¼Œç°ä»£ç¼–è¯‘å™¨ä¼šé‡‡ç”¨RVO(return value optimization)<strong>è¿”å›å€¼ä¼˜åŒ–</strong>æ¥é¿å…æ‹·è´æ„é€ ï¼‰</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">MyClass</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> foo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyClass obj;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // è¿”å›å€¼éœ€è¦æ‹·è´æ„é€ ï¼ˆå¯èƒ½è¢« RVO/NRVO ä¼˜åŒ–æ‰ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>å¯¹è±¡éœ€è¦é€šè¿‡å¦å¤–ä¸€ä¸ªæœªåˆå§‹åŒ–è¿‡çš„å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼›ï¼ˆå¦‚ä¸Š2.é¢˜ä¸­çš„ç¬¬å››ä¸ªå‡½æ•°ï¼‰</li></ol><h4 id="_3-1-c-ä¸­å¦‚ä½•è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜" tabindex="-1"><a class="header-anchor" href="#_3-1-c-ä¸­å¦‚ä½•è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜"><span>3.1 C++ä¸­å¦‚ä½•è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜ï¼Ÿ</span></a></h4><ol><li>å‹å…ƒå‡½æ•°</li><li>é€šè¿‡ç›®æ ‡ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">private:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> privateData;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    MyClass</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> data</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) : </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">privateData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(data) {}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // 2.ç±»çš„è®¿é—®å™¨å‡½æ•°ï¼Œå¯è·å–ç§æœ‰æˆå‘˜çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> getPrivateData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> privateData;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // 1.å‹å…ƒå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    friend</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> accessPrivate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">MyClass</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);       </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> accessPrivate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">MyClass</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">privateData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyClass </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">42</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">privateData</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //âŒ ç§æœ‰å˜é‡æ— æ³•è¢«ç›´æ¥è®¿é—®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Private data: &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getPrivateData</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//âœ… å¯é€šè¿‡ç±»çš„æˆå‘˜å‡½æ•°è®¿é—®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Private data: &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  &lt;&lt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> accessPrivate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(obj) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//âœ… å¯é€šè¿‡å‹å…ƒå‡½æ•°è®¿é—®</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-å“ªäº›å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#_4-å“ªäº›å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°"><span>4.å“ªäº›å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ï¼Ÿ</span></a></h3><p>ç­”å‡ºä¸¤ä¸‰ä¸ªå¸¸è§çš„å³å¯ï¼Œå¹¶è¯´æ˜ä¸ºä»€ä¹ˆä¸èƒ½æ˜¯è™šå‡½æ•°ã€‚</p><p>è™šå‡½æ•°çš„æœ¬è´¨æ˜¯é€šè¿‡ <strong>è™šå‡½æ•°è¡¨æŒ‡é’ˆï¼ˆvptrï¼‰+ è™šå‡½æ•°è¡¨ï¼ˆvtableï¼‰</strong> å®ç°çš„å¤šæ€ï¼›å±äºè¿è¡Œæ—¶é˜¶æ®µ(runtime)è€Œéç¼–è¯‘æ—¶é˜¶æ®µ(compile time)ï¼›è™šå‡½æ•°å¿…é¡»æ˜¯ç±»çš„æˆå‘˜å‡½æ•°</p><ol><li><strong>é™æ€æˆå‘˜å‡½æ•°</strong>ï¼šé™æ€æˆå‘˜å‡½æ•°å±äºç±»æœ¬èº«ï¼Œè€Œä¸å±äºç±»çš„ä»»ä½•å¯¹è±¡ï¼Œæ²¡æœ‰thisæŒ‡é’ˆï¼Œæ— æ³•å®ç°å¤šæ€ï¼›ï¼ˆæ‰©å±•ï¼Œ<strong>é™æ€äºŒå­—è¡¨é¢å…¶åœ¨ç¼–è¯‘å™¨é˜¶æ®µå·²ç»ç¡®å®š</strong>ï¼Œæ— æ³•åœ¨è¿è¡Œæ—¶åŠ¨æ€ç»‘å®šï¼‰</li><li><strong>æ„é€ å‡½æ•°</strong>ï¼ˆææ„å‡½æ•°æ˜¯ä¸æ˜¯è™šå‡½æ•°ï¼Ÿå¯ä»¥æ˜¯ï¼‰ï¼šå¯¹è±¡åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œè™šå‡½æ•°è¡¨æŒ‡é’ˆvptrè¿˜æœªåˆå§‹åŒ–ï¼Œæ— æ³•å®ç°åŠ¨æ€ç»‘å®šï¼›ï¼ˆæ‰©å±•ï¼Œå¦‚æœç±»è¦ä½œä¸ºåŸºç±»å¹¶è¢«å¤šæ€ä½¿ç”¨ â†’ ææ„å‡½æ•°ä¸€å®šè¦æ˜¯è™šå‡½æ•°ï¼ˆå› ä¸ºå®ƒè¦å¯¹çˆ¶ç±»å’Œå­ç±»åŒæ—¶ææ„ï¼‰ï¼›å¦‚æœä¸ä½œä¸ºåŸºç±»åˆ™ä¸éœ€è¦ã€‚ï¼‰</li><li><strong>å‹å…ƒå‡½æ•°</strong>ï¼šå‹å…ƒå‡½æ•°ä¸æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ï¼Œå®ƒåªæ˜¯è¢«æˆäºˆäº†è®¿é—®ç±»çš„ç§æœ‰æˆå‘˜çš„æƒé™ï¼›</li><li><strong>å†…è”å‡½æ•°</strong>ï¼šåŒé™æ€ä¸€æ ·ï¼Œå†…è”å‡½æ•°åœ¨ç¼–è¯‘å™¨é˜¶æ®µå·²ç»ç¡®å®šï¼›</li></ol><p>æ‰©å±•ï¼š<strong>è™šå‡½æ•°å’Œçº¯è™šå‡½æ•°çš„åŒºåˆ«</strong>ï¼šè™šå‡½æ•°æ˜¯åŸºç±»ä¸­ç”¨ virtual ä¿®é¥°çš„å‡½æ•°ï¼Œå¯ä»¥æœ‰å‡½æ•°ä½“ï¼Œå­ç±»å¯ä»¥é€‰æ‹©æ˜¯å¦é‡å†™overrideã€‚<strong>çº¯è™šå‡½æ•°</strong>æ˜¯ç”¨ =0 å®šä¹‰çš„è™šå‡½æ•°ï¼Œæ²¡æœ‰å‡½æ•°ä½“ï¼Œ<strong>è¦æ±‚å­ç±»å¿…é¡»overrideå®ç°</strong>ã€‚</p><h3 id="_5-unique-ptrã€shared-ptrã€auto-ptrçš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_5-unique-ptrã€shared-ptrã€auto-ptrçš„åŒºåˆ«"><span>5. unique_ptrã€shared_ptrã€auto_ptrçš„åŒºåˆ«ï¼Ÿ</span></a></h3><ol><li>unique_ptrï¼šä¸æ”¯æŒæ‹·è´ï¼Œåªæ”¯æŒæŒ‡é’ˆæ‰€æœ‰æƒçš„è½¬ç§»ï¼›</li><li>shared_ptrï¼šæ”¯æŒæ‹·è´ï¼Œå†…éƒ¨æœ‰å¼•ç”¨è®¡æ•°ï¼Œæœ€åä¸€ä¸ª shared_ptr ææ„æ—¶æ‰é‡Šæ”¾èµ„æºï¼›</li><li>auto_ptrï¼šæ‹·è´æˆ–èµ‹å€¼æ—¶ï¼Œæ‰€æœ‰æƒä¼šè½¬ç§»ï¼Œè¢«èµ‹å€¼çš„ä¸€æ–¹å¤±å»æ‰€æœ‰æƒï¼Œç½®ä¸º nullptrã€‚ï¼ˆ<strong>C++11å·²å¼ƒç”¨</strong>ï¼‰</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;memory&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 1. unique ptr</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::unique_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr1;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    ptr1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">reset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">42</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æˆ–è€…std::unique_ptr&lt;int&gt; ptr1(new int(42)); å› ä¸ºunique_ptr çš„æ„é€ å‡½æ•°æ¥å—è£¸æŒ‡é’ˆï¼Œä½†èµ‹å€¼å¿…é¡»ç”¨ reset æˆ–åˆå§‹åŒ–ã€‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::unique_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr2;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ptr2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr1;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //âŒ unique_pträ¸æ”¯æŒæ‹·è´</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ptr2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">move</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(ptr1);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //âœ… æŒ‡é’ˆçš„æ‰€æœ‰æƒéšä¹‹è½¬ç§» print ptr1.get()ä¼šå¾—åˆ° nullptr</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 2. shared ptr</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::unique_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ptr1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">43</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    std::shared_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr2;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    ptr2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //âœ… å¼•ç”¨è®¡æ•°+1ï¼Œptr1.use_count() == ptr2.use_count() == 2</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ï¼›</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-å››ç§å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯ä»€ä¹ˆ-å®ƒä»¬çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_6-å››ç§å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯ä»€ä¹ˆ-å®ƒä»¬çš„åŒºåˆ«"><span>6.å››ç§å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä»¬çš„åŒºåˆ«ï¼Ÿ</span></a></h3><ol><li><strong>const_cast</strong>ï¼šå»æ‰æˆ–æ·»åŠ  const / volatile é™å®šã€‚</li><li><strong>static_cast</strong>ï¼šåŸºæœ¬ç±»å‹è½¬æ¢ï¼ˆ<strong>ä¸Šã€ä¸‹è¡Œè½¬æ¢éƒ½å¯ç”¨</strong>ï¼‰ï¼Œä½†ä½¿ç”¨å®ƒå®ç°çˆ¶ç±»è½¬å­ç±»(ä¸‹è¡Œè½¬æ¢)ä¸å¤ªå®‰å…¨ã€‚ï¼ˆæ‰©å±•ï¼Œå¦‚æœç¨‹åºå‘˜å¯ä»¥ç¡®è®¤è¯¥çˆ¶ç±»è½¬å­ç±»æ˜¯å®‰å…¨çš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆç”¨static_castæ¯”dynamic_castæ€§èƒ½æ›´ä½³ï¼‰</li><li><strong>dynamic_cast</strong>ï¼šä»…ç”¨äº<strong>ä¸‹è¡Œè½¬æ¢</strong>ï¼Œ<strong>å®‰å…¨</strong>ï¼Œå¤±è´¥è¿”å› nullptrã€‚</li><li><strong>reinterpret_cast</strong>ï¼šç”¨äºåº•å±‚ç±»å‹ä¹‹é—´çš„è½¬æ¢ï¼Œä¾‹å¦‚float=&gt;float4ã€‚</li></ol><p><strong>æ³¨æ„ï¼šä¸Šè¡Œè½¬æ¢æ˜¯ç»å¯¹å®‰å…¨çš„</strong></p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å®šä¹‰çˆ¶ç±»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Shape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å®šä¹‰å­ç±»</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Circle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> : </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Shape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    Circle circle;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// åˆ›å»ºå­ç±»å¯¹è±¡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å‘ä¸Šè½¬æ¢ï¼šå­ç±»æŒ‡é’ˆè½¬æ¢ä¸ºçˆ¶ç±»æŒ‡é’ˆï¼Œç»å¯¹å®‰å…¨ã€‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    Shape</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> shapePtr </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;"> &amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">circle;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //ä¸éœ€è¦æ˜¾å¼å†™ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸º Shape* shapePtr = static_cast&lt;Shape*&gt;(&amp;circle); </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å‘ä¸‹è½¬æ¢ï¼šçˆ¶ç±»æŒ‡é’ˆè½¬æ¢ä¸ºå­ç±»æŒ‡é’ˆï¼Œç¨‹åºå‘˜ç¡®ä¿å®‰å…¨æ—¶å¯ç”¨static_castï¼Œå¼€é”€å°ï¼›</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    Circle</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> circlePtr </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#ABB2BF;"> static_cast</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Circle</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(shapePtr);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å‘ä¸‹è½¬æ¢ï¼šçˆ¶ç±»æŒ‡é’ˆè½¬æ¢ä¸ºå­ç±»æŒ‡é’ˆï¼Œç¨‹åºå‘˜æ— æ³•ç¡®ä¿å®‰å…¨æ—¶å¯ç”¨dynamic_castï¼Œå¼€é”€å¤§ï¼›</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    Circle</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> circlePtr </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#ABB2BF;"> dynamic_cast</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Circle</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(shapePtr);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-constå’Œconstexperçš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_7-constå’Œconstexperçš„åŒºåˆ«"><span>7.constå’Œconstexperçš„åŒºåˆ«ï¼Ÿ</span></a></h3><ol><li>conståªè¡¨ç¤º<strong>åªè¯»è¯­ä¹‰</strong>ï¼Œconstexprè¡¨ç¤º<strong>å¸¸é‡è¯­ä¹‰</strong>ï¼›</li><li>constexprç”¨ä½œä¿®é¥°ç¼–è¯‘æœŸå¸¸é‡ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸæå‰å¤„ç†ä»¥å‡å°‘runtimeæ—¶é—´ï¼›å¯å¹¿æ³›ç”¨äºæ¨¡ç‰ˆå‚æ•°ï¼ˆå› ä¸ºæ¨¡ç‰ˆå‚æ•°æ˜¯è¦åœ¨ç¼–è¯‘æœŸç¡®å®šçš„ï¼‰</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  //å®ƒæ˜¯å˜é‡ï¼Œåœ¨runtimeæ—¶è®¡ç®—å¾—å‡ºï¼Œä¸å¯ä¼ å…¥æ¨¡ç‰ˆå‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">constexpr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> +</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //å®ƒæ˜¯å¸¸é‡ï¼Œåœ¨ç¼–è¯‘æœŸå³å¯è¢«ç¼–è¯‘å™¨ç®—å‡ºç¡®å®šï¼Œå¯ä¼ å…¥æ¨¡ç‰ˆå‚æ•°</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_8-shared-pträ¸­çš„å¼•ç”¨è®¡æ•°ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„å®ç°-å¯ä»¥ç”¨staticå˜é‡æ¥å®ç°å—-ä¸ºä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_8-shared-pträ¸­çš„å¼•ç”¨è®¡æ•°ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„å®ç°-å¯ä»¥ç”¨staticå˜é‡æ¥å®ç°å—-ä¸ºä»€ä¹ˆ"><span>8. shared_pträ¸­çš„å¼•ç”¨è®¡æ•°ç”¨ä»€ä¹ˆæ•°æ®ç»“æ„å®ç°ï¼Ÿå¯ä»¥ç”¨staticå˜é‡æ¥å®ç°å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</span></a></h3><p>int*</p><p>ä¸èƒ½ï¼</p><p><strong>staticä¿®é¥°çš„å˜é‡å±äºç±»æ‰€æœ‰</strong>ï¼Œè€Œæ¯ä¸ªshared_ptrçš„æ˜¯åŒä¸€ç±»çš„ä¸åŒå¯¹è±¡ï¼Œå¦‚æœé‡‡ç”¨staticä¿®é¥°ï¼Œåˆ™ä¸åŒçš„shared_ptrçš„å¼•ç”¨è®¡æ•°éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œä¼šå¯¼è‡´è®¡æ•°é”™è¯¯ã€‚è§å¦‚ä¸‹ä¾‹å­</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">shared_ptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ptr1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">42</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //ptr1æ˜¯shared_ptrç±»çš„ä¸€ä¸ªå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">shared_ptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ptr2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">43</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //åŒç†ï¼Œptr2æ˜¯shared_ptrç±»çš„å¦ä¸€ä¸ªå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">shared_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr3;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ptr3 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ptr2;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ­¤æ—¶ptr3çš„å¼•ç”¨è®¡æ•° == ptr2çš„å¼•ç”¨è®¡æ•° == 2ï¼Œptr1çš„å¼•ç”¨è®¡æ•°ä¸º1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//å¦‚æœé‡‡ç”¨staticå˜é‡æ¥å®ç°shared_ptrçš„å¼•ç”¨è®¡æ•°ï¼Œåˆ™ptr1ã€ptr2ã€ptr3çš„å¼•ç”¨è®¡æ•°éƒ½æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œéƒ½ä¸º2ï¼Œptr1è®¡æ•°é”™è¯¯äº†ã€‚</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_9-shared-pträ¸­çš„å¼•ç”¨è®¡æ•°å¯ä»¥ç”¨intç±»å‹å—-å¦‚æœå¯ä»¥-ä¸‹é¢çš„ä»£ç ä¼šå‘ç”Ÿä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_9-shared-pträ¸­çš„å¼•ç”¨è®¡æ•°å¯ä»¥ç”¨intç±»å‹å—-å¦‚æœå¯ä»¥-ä¸‹é¢çš„ä»£ç ä¼šå‘ç”Ÿä»€ä¹ˆ"><span>9. shared_pträ¸­çš„å¼•ç”¨è®¡æ•°å¯ä»¥ç”¨intç±»å‹å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œä¸‹é¢çš„ä»£ç ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> shared_ptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //å¦‚æœè¿™é‡Œç”¨intç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">shared_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> make_shared</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ­¤æ—¶açš„è®¡æ•°ä¸º1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">shared_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ­¤æ—¶bçš„è®¡æ•°ä¸º2ï¼ˆæ‹·è´æ„é€ å‡½æ•°åœ¨açš„å¼•ç”¨è®¡æ•°å™¨ä¸Š+1 = bçš„è®¡æ•°ï¼‰ï¼Œaçš„è®¡æ•°è¿˜ä¸º1ï¼Œä½†æ˜¯aæœ¬è¯¥ä¹Ÿä¸º2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">shared_ptr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> c </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //åŒç†cçš„è®¡æ•°ä¸º2ï¼Œaçš„è®¡æ•°ä¸º1ï¼Œä½†æ˜¯aæœ¬è¯¥ä¹Ÿä¸º2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»¥ä¸Šä»£ç å¦‚æœä½¿ç”¨æ­£ç¡®çš„int*,åˆ™å¯æ­£ç¡®è®¡æ•°ã€‚å› ä¸º<strong>int*æ˜¯æŒ‡é’ˆï¼ŒæŒ‡å‘åŒä¸€å—ç©ºé—´ï¼Œbã€cè®¡æ•°æ”¹å˜æ—¶ï¼Œå®ƒä»¬çš„è®¡æ•°å™¨ä¸ºåŒä¸€å—bufferï¼Œaä¹Ÿä¼šæ›´ç€åŒæ—¶å˜åŒ–çš„</strong>ã€‚</p><h3 id="_10-ä»¥ä¸‹ä»£ç å¯ä»¥å¦‚ä½•ä¼˜åŒ–-è¿™æ˜¯ä»€ä¹ˆä¼˜åŒ–åŸç†-raii" tabindex="-1"><a class="header-anchor" href="#_10-ä»¥ä¸‹ä»£ç å¯ä»¥å¦‚ä½•ä¼˜åŒ–-è¿™æ˜¯ä»€ä¹ˆä¼˜åŒ–åŸç†-raii"><span>10. ä»¥ä¸‹ä»£ç å¯ä»¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿè¿™æ˜¯ä»€ä¹ˆä¼˜åŒ–åŸç†ï¼Ÿï¼ˆRAIIï¼‰</span></a></h3><p>æˆ‘ä»¬æƒ³è®©ç¼–è¯‘å™¨è‡ªåŠ¨é‡Šæ”¾ä¸€äº›èµ„æºï¼Œè¿™æ ·å¯ä»¥è®©æˆ‘ä»¬ä¸ç”¨æ‰‹åŠ¨é‡Šæ”¾èµ„æºï¼Œé¿å…èµ„æºæ³„éœ²ã€‚</p><p>è¿™å°±ç”¨åˆ°äº†RAIIï¼ˆResource Acquisition Is Initializationï¼‰ç‰¹æ€§ï¼šåœ¨mainå‡½æ•°ä¸­å°†å¯¹è±¡åˆå§‹åŒ–ä¸ºä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œåœ¨ä½¿ç”¨å®Œæˆåç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨å¯¹è±¡çš„ææ„å‡½æ•°ï¼Œä»è€Œé‡Šæ”¾èµ„æºã€‚</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;memory&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    Resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Resource acquired.&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ææ„å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ~Resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Resource released.&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Using the resource.&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // åˆå§‹åŒ–å±€éƒ¨å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    Resource r </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Resource</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ä½¿ç”¨ resource å¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    r</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">use</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // main å‡½æ•°ç»“æŸæ—¶ï¼Œresource å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç»“æŸï¼Œå…¶ææ„å‡½æ•°ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // è¿™å°†é‡Šæ”¾ Resource å¯¹è±¡æ‰€å ç”¨çš„èµ„æº</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//Resource acquired.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//Using the resource.</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//Resource released.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_11-å¤šä¸ªif-elseä¸‹éƒ½æ˜¯é«˜åº¦é‡å¤çš„ä»£ç -å¹¶ä¸”è°ƒç”¨äº†å¤§é‡çš„å‡½æ•°å‚æ•°-å¯ä»¥å¦‚ä½•ç®€åŒ–è¿™æ®µä»£ç " tabindex="-1"><a class="header-anchor" href="#_11-å¤šä¸ªif-elseä¸‹éƒ½æ˜¯é«˜åº¦é‡å¤çš„ä»£ç -å¹¶ä¸”è°ƒç”¨äº†å¤§é‡çš„å‡½æ•°å‚æ•°-å¯ä»¥å¦‚ä½•ç®€åŒ–è¿™æ®µä»£ç "><span>11. å¤šä¸ªif elseä¸‹éƒ½æ˜¯é«˜åº¦é‡å¤çš„ä»£ç ï¼Œå¹¶ä¸”è°ƒç”¨äº†å¤§é‡çš„å‡½æ•°å‚æ•°ï¼Œå¯ä»¥å¦‚ä½•ç®€åŒ–è¿™æ®µä»£ç ï¼Ÿ</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> TestFun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a, b, c;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .....</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // å·´æ‹‰å·´æ‹‰çš„ä¸€å †å˜é‡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶1)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // é™¤äº†å‡ ä¸ªå˜é‡ä¸åŒå¤–éƒ½æ˜¯ç›¸åŒçš„ä»£ç å—</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // å…¶ä¸­ä½¿ç”¨aã€bã€c....ä¸€å †å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        func</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(a,b,c,d,e,f,g...)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶2ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // é™¤äº†å‡ ä¸ªå˜é‡ä¸åŒå¤–éƒ½æ˜¯ç›¸åŒçš„ä»£ç å—</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // å…¶ä¸­ä½¿ç”¨aã€bã€c....ä¸€å †å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶3)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // é™¤äº†å‡ ä¸ªå˜é‡ä¸åŒå¤–éƒ½æ˜¯ç›¸åŒçš„ä»£ç å—        // å…¶ä¸­ä½¿ç”¨aã€bã€c....ä¸€å †å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç­”ï¼šlambdaè¡¨è¾¾å¼</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> std</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> TestFun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, b </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, c </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // å…¬å…±å˜é‡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> d </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, e </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           // å…¬å…±å˜é‡</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // å®šä¹‰ä¸€ä¸ª lambdaï¼ŒæŠŠé‡å¤çš„ä»£ç æ”¾åœ¨é‡Œé¢</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    auto</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> lambdaFun </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">](</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> param</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // è¿™é‡Œå¯ä»¥ç›´æ¥ç”¨å¤–éƒ¨å˜é‡ a,b,c,d,eï¼ˆå› ä¸ºæˆ‘ä»¬ç”¨ &amp; æ•è·äº†ï¼‰ ï¼ï¼ï¼ï¼ï¼ï¼åªå†™ç‰¹æ®Šå˜é‡paramå³å¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;a+b+c = &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> c) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;d*e   = &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (d </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> e) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> endl;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // åªæœ‰ param æ˜¯ä¸åŒçš„</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;param = &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> param </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    };</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ä¸åŒæ¡ä»¶ä¸‹ï¼Œåªä¼ ä¸åŒçš„å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    bool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> æ¡ä»¶1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    bool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> æ¡ä»¶2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> false</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    bool</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> æ¡ä»¶3 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶1) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        lambdaFun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // param1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶2) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        lambdaFun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // param2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (æ¡ä»¶3) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        lambdaFun</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // param3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//è¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 60</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">param </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">a</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">b</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">c </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 60</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">d</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e   </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2000</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">param </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 300</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_12-æ¨¡ç‰ˆå‡½æ•°æœ‰å“ªäº›ç¼–è¯‘æ–¹å¼-å“ªä¸ªæ›´å¥½" tabindex="-1"><a class="header-anchor" href="#_12-æ¨¡ç‰ˆå‡½æ•°æœ‰å“ªäº›ç¼–è¯‘æ–¹å¼-å“ªä¸ªæ›´å¥½"><span>12. æ¨¡ç‰ˆå‡½æ•°æœ‰å“ªäº›ç¼–è¯‘æ–¹å¼ï¼Ÿå“ªä¸ªæ›´å¥½ï¼Ÿ</span></a></h3><p>ä¸€ä½“åŒ–ç¼–è¯‘ä¼šå¢åŠ ç¼–è¯‘æ—¶é—´ï¼Œåˆ†ç¦»å¼ç¼–è¯‘ä¼šå¤šæ¬¡é‡å¤æ˜¾å¼å®ä¾‹åŒ–ï¼Œä¸”å¤šä¸ªcppå¯èƒ½å®ä¾‹åŒ–åŒä¸€æ¨¡æ¿é€ æˆç»´æŠ¤å›°éš¾ï¼›å‰è€…å¯èƒ½é€ æˆå¯æ‰§è¡Œæ–‡ä»¶è†¨èƒ€ï¼ˆç”±äºæ¯ä¸ªcppæ–‡ä»¶éƒ½ä¼šå¯¼å…¥.hå¤´æ–‡ä»¶ï¼Œå¤´æ–‡ä»¶ä¸­ç”±äºå·²ç»å®ä¾‹åŒ–å› æ­¤ä¼šé€ æˆé‡å¤ä»£ç çš„å¯¼å…¥ï¼‰ã€‚</p><p>ä½†ä»ç„¶ä¸€èˆ¬<strong>æ¨èä¸€ä½“åŒ–ç¼–è¯‘</strong></p><ol><li><strong>ä¸€ä½“åŒ–ç¼–è¯‘</strong> ï¼šæ¨¡æ¿ç±»æˆ–å‡½æ•°çš„ å£°æ˜ + å®šä¹‰éƒ½æ”¾åœ¨å¤´æ–‡ä»¶ã€‚è°ƒç”¨æ—¶<strong>ç¼–è¯‘å™¨èƒ½ç›´æ¥çœ‹åˆ°å®Œæ•´å®šä¹‰ï¼Œä»è€Œå®ä¾‹åŒ–</strong>ã€‚æœ€å¸¸è§çš„æ–¹å¼ï¼ŒC++STLã€NVçš„cutlass ç­‰å¾ˆå¤šç»„ä»¶éƒ½æ˜¯è¿™æ ·ã€‚</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// MyTemplate.h</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><strong>åˆ†ç¦»å¼ç¼–è¯‘</strong>ï¼šæ¨¡æ¿çš„ å£°æ˜æ”¾åœ¨ .hï¼Œå®šä¹‰æ”¾åœ¨ .cppã€‚å› ä¸ºç¼–è¯‘å™¨åœ¨çœ‹åˆ° .h æ—¶å¹¶ä¸çŸ¥é“ <strong>.cpp é‡Œçš„å®šä¹‰ï¼Œæ‰€ä»¥å¿…é¡»æ˜¾å¼å®ä¾‹åŒ–</strong>éœ€è¦çš„ç±»å‹ï¼Œå¦åˆ™ä¼šæŠ¥é“¾æ¥é”™è¯¯ã€‚</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// MyTemplate.h</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// MyTemplate.cpp</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;MyTemplate.h&quot;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b; }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// æ˜¾å¼å®ä¾‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> double</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_13-æ¨¡æ¿å®ä¾‹åŒ–ã€ç‰¹ä¾‹åŒ–ã€åç‰¹åŒ–çš„æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#_13-æ¨¡æ¿å®ä¾‹åŒ–ã€ç‰¹ä¾‹åŒ–ã€åç‰¹åŒ–çš„æ¦‚å¿µ"><span>13. æ¨¡æ¿å®ä¾‹åŒ–ã€ç‰¹ä¾‹åŒ–ã€åç‰¹åŒ–çš„æ¦‚å¿µï¼Ÿ</span></a></h3><ol><li>æ¨¡æ¿å®ä¾‹åŒ–ï¼šç¼–è¯‘å™¨åœ¨çœ‹åˆ°å…·ä½“ç±»å‹æ—¶ï¼Œæ ¹æ®æ¨¡æ¿ç”Ÿæˆå¯¹åº”çš„å…·ä½“å‡½æ•°æˆ–ç±»ã€‚</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// å‡½æ•°æ¨¡æ¿</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> a </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> b; }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       // éšå¼å®ä¾‹åŒ– -&gt; ç”Ÿæˆ add&lt;int&gt;(int, int)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   // éšå¼å®ä¾‹åŒ– -&gt; ç”Ÿæˆ add&lt;double&gt;(double, double)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // æ˜¾å¼å®ä¾‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    template </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> add</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>æ¨¡æ¿ç‰¹ä¾‹åŒ–ï¼šä¸ºæŸä¸ªç‰¹å®šç±»å‹æä¾›å®Œå…¨ä¸åŒçš„å®ç°ï¼Œè¦†ç›–åŸæœ‰çš„é€šç”¨æ¨¡æ¿ã€‚</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// é€šç”¨æ¨¡æ¿</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Printer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> val</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> val </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl; }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç‰¹ä¾‹åŒ–ï¼šchar* çš„æ‰“å°æ–¹å¼ä¸åŒ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Printer</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">char*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">char*</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> val</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) { std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;C-string: &quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> val </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl; }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>æ¨¡æ¿åç‰¹åŒ–ï¼šä¸æ˜¯é’ˆå¯¹æŸä¸€ä¸ªå®Œå…¨ç¡®å®šçš„ç±»å‹ï¼Œè€Œæ˜¯é’ˆå¯¹ ä¸€ç±»ç±»å‹æ¨¡å¼ æä¾›ç‰¹æ®Šå®ç°ã€‚</li></ol><p><strong>éƒ¨åˆ†å‚æ•°ç‰¹åŒ–</strong>ï¼ˆä¸ªæ•°ä¸Šçš„åç‰¹åŒ–ï¼‰</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// åŸå§‹çš„æ¨¡æ¿å®šä¹‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;General template&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// éƒ¨åˆ†å‚æ•°åç‰¹åŒ–ï¼Œå¯¹ç¬¬äºŒä¸ªå‚æ•°ç‰¹åŒ–ä¸º int ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Partial specialization with T2 = int&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyTemplate</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">char&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj1;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    obj1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è°ƒç”¨é€šç”¨æ¨¡æ¿çš„ print å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyTemplate</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj2;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    obj2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è°ƒç”¨éƒ¨åˆ†ç‰¹åŒ–æ¨¡æ¿çš„ print å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å‚æ•°èŒƒå›´çš„åç‰¹åŒ–</strong>ï¼ˆèŒƒå›´ä¸Šçš„åç‰¹åŒ–ï¼‰</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// åŸå§‹çš„æ¨¡æ¿å®šä¹‰</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;General template&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// ç±»å‹èŒƒå›´åç‰¹åŒ–ï¼Œå¯¹æŒ‡é’ˆç±»å‹è¿›è¡Œç‰¹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">typename</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> T</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> MyTemplate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">T</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        std::cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Partial specialization for pointer types&quot;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> &lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::endl;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyTemplate</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> obj1;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    obj1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è°ƒç”¨é€šç”¨æ¨¡æ¿çš„ print å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> num </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    MyTemplate</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;int*&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> obj2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">num);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    obj2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // è°ƒç”¨æŒ‡é’ˆç±»å‹åç‰¹åŒ–æ¨¡æ¿çš„ print å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_14-ä½¿ç”¨æ¨¡ç‰ˆæ¥å®ç°ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—-çœ‹çœ‹å°±å¥½" tabindex="-1"><a class="header-anchor" href="#_14-ä½¿ç”¨æ¨¡ç‰ˆæ¥å®ç°ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—-çœ‹çœ‹å°±å¥½"><span>14. ä½¿ç”¨æ¨¡ç‰ˆæ¥å®ç°ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆçœ‹çœ‹å°±å¥½ï¼‰</span></a></h3><p>è¿™ä¸ªæ˜¯ä¸ªæ¨¡ç‰ˆå…ƒå‡½æ•°çš„å…¸å‹ä¾‹å­ï¼Œåˆ©ç”¨äº†æ¨¡ç‰ˆçš„é€’å½’æ€§</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> std</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 1.ä½¿ç”¨staticç¡®ä¿ç”Ÿæˆçš„valueæ˜¯å±äºæ•´ä¸ªç±»Fibonacciï¼Œè€ŒéæŸä¸ªå¯¹è±¡ï¼Œå› æ­¤è¯¥ç±»çš„æ‰€æœ‰æˆå‘˜å¯ä»¥ç›´æ¥è®¿é—®æ— éœ€æ¯ä¸ªå¯¹è±¡éƒ½åˆå§‹åŒ–è¿™ä¸ªå˜é‡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// 2.ä½¿ç”¨constexprï¼Œ æœ€ç»ˆç»“æœ 55 åœ¨ç¼–è¯‘æœŸå°±èƒ½ç®—å‡ºæ¥ï¼Œè¿è¡Œæ—¶åªæ˜¯æ‰“å°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> N</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Fibonacci</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> constexpr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> value </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Fibonacci&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">N</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;::value </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Fibonacci&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">N</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;::value;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Fibonacci</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> constexpr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> value </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">template</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> Fibonacci</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    static</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> constexpr</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> value </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    const</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> Fibonacci&lt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;::value;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_15-ä»¥ä¸‹ä»£ç ä¼šè°ƒç”¨å“ªäº›å‡½æ•°-è®²è®²c-çš„å³å€¼æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#_15-ä»¥ä¸‹ä»£ç ä¼šè°ƒç”¨å“ªäº›å‡½æ•°-è®²è®²c-çš„å³å€¼æœ‰å“ªäº›"><span>15.ä»¥ä¸‹ä»£ç ä¼šè°ƒç”¨å“ªäº›å‡½æ•°ï¼Ÿè®²è®²C++çš„å³å€¼æœ‰å“ªäº›ï¼Ÿ</span></a></h3><p>cppä¸­å³å€¼ (rvalue) æŒ‡çš„æ˜¯ï¼š<strong>ä¸èƒ½å‡ºç°åœ¨èµ‹å€¼è¯­å¥å·¦è¾¹çš„å€¼</strong>ã€‚<br> å³å€¼æœ‰ä¸¤ç§ç±»å‹ï¼Œçº¯å³å€¼å’Œå°†äº¡å€¼ã€‚</p><ol><li><strong>çº¯å³å€¼</strong>ï¼šå­—é¢å€¼ï¼ˆä¾‹ï¼š0ã€1ã€2ï¼‰ï¼Œè¡¨è¾¾å¼ï¼ˆä¾‹ï¼šx+yï¼‰ï¼Œè¿”å›çš„å¯¹è±¡</li><li><strong>å°†äº¡å€¼</strong>ï¼šå±äºå¯¹è±¡ï¼Œä½†å³å°†è¢«é”€æ¯ï¼Œå¯ä»¥â€œçªƒå–èµ„æºâ€ã€‚ä¾‹å¦‚ std<iconify-icon class="vp-icon" icon="fa6-solid:move(a)ã€ static_cast&lt;A&amp;&amp;&gt;(a)ä¸­çš„aï¼ˆå¯¹åº”ä¸‹æ–¹ä»£ç çš„o" height=" std" sizing="height" style="--icon-size: std;"></iconify-icon>move(obj)ä¸­çš„objï¼‰ã€‚</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BigObj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">public:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    explicit</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BigObj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">size_t</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        : </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">length_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(length), </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">new</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[length]) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ææ„</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    ~BigObj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">     if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (data_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> NULL</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       delete[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data_;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        length_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // æ‹·è´æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    BigObj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> default</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // èµ‹å€¼è¿ç®—ç¬¦</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> operator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> default</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ç§»åŠ¨æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    BigObj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) : </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">nullptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">length_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        length_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        //ç§»åŠ¨æ„é€ å‡½æ•°åï¼Œæ²¡æœ‰å°†åŸå¯¹è±¡å›å¤é»˜è®¤å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // ç§»åŠ¨èµ‹å€¼å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">    BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> operator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">BigObj</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&amp;&amp;</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">noexcept</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> !=</span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;"> &amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">other) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        delete[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data_;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        data_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        length_ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length_</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">data_</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> nullptr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        other</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">length_</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">this</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">private:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    size_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> length_;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    int*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> data_;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">BigObj</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> func</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> a</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> b</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">){</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//RVO</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   BigObj </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">obj</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ„é€ å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   BigObj o;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ„é€ å‡½æ•°</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    o </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> std::</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">move</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(obj);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //ç§»åŠ¨èµ‹å€¼ï¼ˆå› ä¸ºoå·²ç»è¢«åˆ›å»ºäº†ï¼Œå› æ­¤è¿™é‡Œä¸æ˜¯æ‹·è´æ„é€ å‡½æ•°ï¼‰ï¼Œå°†objè½¬ä¸ºå³å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   }</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//ææ„oå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   //{}è¡¨ç¤ºä¸€ä¸ªä½œç”¨åŸŸï¼Œç¦»å¼€è¿™ä¸ªä½œç”¨åŸŸoé©¬ä¸Šå°±ä¼šè¢«ææ„</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">   return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//ææ„ocjå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äºŒ-æ“ä½œç³»ç»Ÿ" tabindex="-1"><a class="header-anchor" href="#äºŒ-æ“ä½œç³»ç»Ÿ"><span>äºŒ. æ“ä½œç³»ç»Ÿ</span></a></h2><p>è¿™ä¸€å—çº¯å…«è‚¡ï¼ŒçŸ¥é“æ“ä½œç³»ç»Ÿè°ƒåº¦ç®—æ³•ã€è¿›ç¨‹çº¿ç¨‹å’Œè™šæ‹Ÿç‰©ç†åœ°å€å³å¯</p><h3 id="_16-ä¸ºä»€ä¹ˆè¦æœ‰è™šæ‹Ÿåœ°å€-ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_16-ä¸ºä»€ä¹ˆè¦æœ‰è™šæ‹Ÿåœ°å€-ç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„åŒºåˆ«"><span>16.ä¸ºä»€ä¹ˆè¦æœ‰è™šæ‹Ÿåœ°å€ï¼Ÿç‰©ç†åœ°å€å’Œè™šæ‹Ÿåœ°å€çš„åŒºåˆ«ï¼Ÿ</span></a></h3><p>ä¸¾ä¸ªä¾‹å­è¯´æ˜ï¼š</p><p>æ¯”å¦‚ï¼Œå•ç‰‡æœºï¼Œå®ƒåªæœ‰ç‰©ç†åœ°å€æ²¡æœ‰è™šæ‹Ÿåœ°å€ï¼Œå› æ­¤å¦‚æœå•ç‰‡æœºä¸Šæœ‰ç¨‹åºï¼Œæˆ‘ç»§ç»­è¾“å…¥æ–°çš„ç¨‹åºå°±ä¼šæŠŠå°±ç¨‹åºç»™coveræ‰ã€‚å®ƒæ²¡æœ‰å†…å­˜æŠ½è±¡ç­‰çš„ä¿æŠ¤å› æ­¤ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œå› æ­¤å‚¬ç”Ÿå‡ºæ¥è™šæ‹Ÿåœ°å€ã€‚</p><ol><li><strong>å†…å­˜æŠ½è±¡</strong>ï¼šè™šæ‹Ÿåœ°å€ä¸ºç¨‹åºæä¾›äº†ä¸€ä¸ª<strong>æŠ½è±¡çš„å†…å­˜ç¯å¢ƒ</strong>ï¼Œä½¿å¾—ç¨‹åºåœ¨è¿è¡Œæ—¶ä¸éœ€è¦è€ƒè™‘ç‰©ç†å†…å­˜åœ°å€ï¼›<strong>ç¨‹åºä½¿ç”¨çš„æ˜¯é€»è¾‘åœ°å€ï¼Œç”±æ“ä½œç³»ç»Ÿæ˜ å°„åˆ°ç‰©ç†åœ°å€</strong>ã€‚</li><li><strong>å†…å­˜ç©ºé—´æ‰©å±•</strong>ï¼šé€šè¿‡è™šæ‹Ÿåœ°å€æŠ€æœ¯ï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥æä¾›æ¯”ç‰©ç†å†…å­˜æ›´å¤§çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼›è¿™ä½¿å¾—å¤šä¸ªç¨‹åºå¯ä»¥å¹¶è¡Œï¼Œæ¯ä¸ªç¨‹åºæ‹¥æœ‰ç‹¬å±äºè‡ªå·±çš„ä¸€å—å†…å­˜ã€‚</li><li><strong>å†…å­˜ä¿æŠ¤</strong>ï¼š<strong>ä¸åŒè¿›ç¨‹æ‹¥æœ‰ä¸åŒçš„è™šæ‹Ÿåœ°å€ç©ºé—´</strong>ï¼Œä¸€ä¸ªè¿›ç¨‹çš„ä»£ç å’Œæ•°æ®ä¸èƒ½è®¿é—®å¦ä¸€ä¸ªè¿›ç¨‹çš„ï¼Œç¡®ä¿äº†ç›¸äº’éš”ç¦»å’Œå®‰å…¨ã€‚</li><li><strong>å†…å­˜ç®¡ç†</strong>ï¼šæ“ä½œç³»ç»Ÿå¯ä»¥é€šè¿‡åˆ†é¡µ(page)æˆ–åˆ†æ®µ(Segmentation)æŠ€æœ¯æ¥åŠ¨æ€çš„å®ç°å†…å­˜çš„åˆ†é…å’Œå›æ”¶ï¼Œæå‡å†…å­˜åˆ©ç”¨ç‡ã€‚</li></ol><h3 id="_16-1-æ—¢ç„¶è™šæ‹Ÿå†…å­˜åœ°å€è¦æ¯”ç‰©ç†å†…å­˜ç©ºé—´è¦å¤§-é‚£å²‚ä¸æ˜¯ä¼šå‡ºç°ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æƒ…å†µ-å¦‚ä½•è§£å†³" tabindex="-1"><a class="header-anchor" href="#_16-1-æ—¢ç„¶è™šæ‹Ÿå†…å­˜åœ°å€è¦æ¯”ç‰©ç†å†…å­˜ç©ºé—´è¦å¤§-é‚£å²‚ä¸æ˜¯ä¼šå‡ºç°ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æƒ…å†µ-å¦‚ä½•è§£å†³"><span>16.1 æ—¢ç„¶è™šæ‹Ÿå†…å­˜åœ°å€è¦æ¯”ç‰©ç†å†…å­˜ç©ºé—´è¦å¤§ï¼Œé‚£å²‚ä¸æ˜¯ä¼šå‡ºç°ç‰©ç†å†…å­˜ä¸å¤Ÿç”¨çš„æƒ…å†µï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</span></a></h3><p>å½“ç‰©ç†å†…å­˜ä¸è¶³æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šä½¿ç”¨**é¡µç½®æ¢ï¼ˆPage Replacementï¼‰**çš„æ–¹æ³•å°†ä¸€äº›ä¸å¸¸ç”¨çš„å†…å­˜ä»ç‰©ç†å†…å­˜ç§»åŠ¨åˆ°ç£ç›˜ä¸Šçš„äº¤æ¢åŒº (Swap) ä¸­ï¼Œè…¾å‡ºç©ºé—´ã€‚</p><p>å½“è¿™äº›é¡µå†æ¬¡è¢«è®¿é—®æ—¶ï¼Œä¼šå‘ç”Ÿç¼ºé¡µä¸­æ–­ (Page Fault)ï¼Œå†æŠŠå®ƒä»¬ä»ç£ç›˜åŠ è½½å›å†…å­˜ã€‚</p><p>å¸¸è§ç®—æ³•ï¼š</p><ul><li>FIFO (å…ˆè¿›å…ˆå‡º)ï¼šæœ€å…ˆè¿›å…¥å†…å­˜çš„é¡µæœ€å…ˆè¢«æ¢å‡ºï¼›</li><li><strong>LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨)</strong>ï¼šä¼˜å…ˆæ¢å‡ºæœ€é•¿æ—¶é—´æ²¡è¢«è®¿é—®çš„é¡µï¼ˆæ‰©å±•ï¼šå¤§æ¨¡å‹æ¨ç†é‡Œé¢æ¯”å¦‚è¯´kvcacheç­‰ä¹Ÿä¼šä½¿ç”¨LRUè¿›è¡Œç®¡ç†ï¼‰ï¼›</li><li>LFU (æœ€å°‘ä½¿ç”¨é¢‘ç‡)ï¼šä¼˜å…ˆæ¢å‡ºä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„é¡µã€‚</li></ul><p><strong>LRUçš„Leetcodeä¸€å®šè¦åšï¼Œè€ƒçš„æ¦‚ç‡å¾ˆå¤§</strong></p><h3 id="_17-è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_17-è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«"><span>17. è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</span></a></h3><p><strong>è¿›ç¨‹æ˜¯æ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚</strong></p><ul><li>è¿›ç¨‹æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ã€ä»£ç æ®µã€æ•°æ®æ®µå’Œå †æ ˆã€‚åˆ‡æ¢å¼€é”€å¤§ã€é€šä¿¡å¤æ‚ï¼Œä½†æ›´ç¨³å®šï¼Œé€‚åˆé«˜éš”ç¦»åœºæ™¯ï¼›</li><li>åŒä¸€è¿›ç¨‹å†…çš„çº¿ç¨‹å…±äº«è¿›ç¨‹çš„åœ°å€ç©ºé—´å’Œèµ„æºï¼Œä½†å„è‡ªæœ‰ç‹¬ç«‹çš„æ ˆå’Œå¯„å­˜å™¨ã€‚åˆ‡æ¢å¼€é”€å°ã€é€šä¿¡ç®€å•ï¼Œä½†å®¹æ˜“äº’ç›¸å½±å“ï¼Œé€‚åˆé«˜å¹¶å‘è®¡ç®—åœºæ™¯ã€‚</li></ul><h2 id="ä¸‰-ai-hpcåŸºç¡€" tabindex="-1"><a class="header-anchor" href="#ä¸‰-ai-hpcåŸºç¡€"><span>ä¸‰. AI-HPCåŸºç¡€</span></a></h2><h3 id="_18-fp32ã€fp16ã€bf16ä¸‰è€…åœ¨ieee754æ ‡å‡†ä¸‹çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_18-fp32ã€fp16ã€bf16ä¸‰è€…åœ¨ieee754æ ‡å‡†ä¸‹çš„åŒºåˆ«"><span>18. FP32ã€FP16ã€BF16ä¸‰è€…åœ¨IEEE754æ ‡å‡†ä¸‹çš„åŒºåˆ«ï¼Ÿ</span></a></h3><table><thead><tr><th>ç±»å‹</th><th>æ€»ä½æ•°</th><th>ç¬¦å·ä½</th><th>æŒ‡æ•°ä½</th><th>å°¾æ•°ä½</th><th>æŒ‡æ•°åç½®</th><th>èŒƒå›´</th><th>å…¸å‹åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>FP32</td><td>32</td><td><strong>1</strong></td><td><strong>8</strong></td><td><strong>23</strong></td><td>127</td><td>~Â±3.4e38</td><td>é«˜ç²¾åº¦è®¡ç®—ã€è®­ç»ƒ</td></tr><tr><td>FP16</td><td>16</td><td><strong>1</strong></td><td><strong>5</strong></td><td><strong>10</strong></td><td>15</td><td>~Â±6.5e4</td><td>AIæ¨ç†ã€èŠ‚çœå†…å­˜</td></tr><tr><td>BF16</td><td>16</td><td><strong>1</strong></td><td><strong>8</strong></td><td><strong>7</strong></td><td>127</td><td>~Â±3.4e38</td><td>AIè®­ç»ƒã€å…¼é¡¾èŒƒå›´å’Œæ•ˆç‡</td></tr></tbody></table><h3 id="_19-fp16ä¸bf16çš„å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_19-fp16ä¸bf16çš„å¯¹æ¯”"><span>19. FP16ä¸BF16çš„å¯¹æ¯”ï¼Ÿ</span></a></h3><p>BF16æ›´é€‚åˆtrainingï¼Œå› ä¸ºæŒ‡æ•°ä½å®½ï¼ŒåŠ¨æ€èŒƒå›´å¤§ï¼Œ<strong>å‡å°‘æ¢¯åº¦çˆ†ç‚¸å’Œæ¢¯åº¦æ¶ˆå¤±</strong>ï¼Œæ›´æœ‰åˆ©äºbackwardï¼›</p><p>FP16æ›´é€‚åˆæ¨ç†ï¼Œæ¨ç†åªæœ‰forwardï¼Œä¸æ¶‰åŠbackwardï¼Œå› æ­¤ä¸è€ƒè™‘æ¢¯åº¦é—®é¢˜ï¼Œåªè€ƒè™‘ç²¾åº¦å³å¯ã€‚FP16<strong>å°¾æ•°ä½å¤šï¼Œå¯¹ç²¾åº¦æ›´å‹å¥½</strong></p><h3 id="_20-å†™å‡ºä»£ç è®¡ç®—1-1-2-1-3-1-4-1-n" tabindex="-1"><a class="header-anchor" href="#_20-å†™å‡ºä»£ç è®¡ç®—1-1-2-1-3-1-4-1-n"><span>20. å†™å‡ºä»£ç è®¡ç®—1+(1/2)+(1/3)+(1/4)+...+(1/n)</span></a></h3><p><a href="https://blog.csdn.net/xieyihua1994/article/details/106137932" target="_blank" rel="noopener noreferrer">float æ•°æ®ç±»å‹çš„ä¸€äº›å‘ï¼ˆå¤§æ•°åƒå°æ•°ï¼‰</a></p><p>é‡ç‚¹æå–ï¼š</p><ol><li>åœ¨æµ®ç‚¹æ•°è®¡ç®—å‰ï¼Œä¼šå…ˆå°†å…¶è½¬ä¸ºäºŒçº§åˆ¶çš„ç§‘å­¦è®¡æ•°ã€‚ep.(-1)^sign * 1.f * 2^e</li><li>æµ®ç‚¹æ•°åŠ æ³•éœ€è¦å…ˆå¯¹é½æŒ‡æ•°ä½å†ç›¸åŠ , ep.0.5+0.125 = (-1)^0 * <strong>1.0</strong> * 2^(-1) + (-1)^0 * <strong>0.01</strong> * 2^(-1) = (-1)^0 * <strong>1.01</strong> * 2^(-1)</li><li>å¤§æ•°åŠ å°æ•°æ—¶ï¼Œä¸ºäº†å¯¹é½æŒ‡æ•°ä½ï¼Œéœ€è¦å·¦ç§»åŠ¨1.fçš„å°æ•°ç‚¹ï¼Œå½“ç§»åŠ¨è¶…è¿‡23ä½æ—¶ï¼Œå°æ•°å˜æˆäº†0ï¼ˆä¾‹å¦‚ï¼š(-1)^0 * <strong>0.0</strong> * 2^(-1)ï¼‰ï¼Œå°±æ„å‘³ç€+çš„è¿™ä¸ªæ•°å°±æ˜¯0ã€‚æ­¤æ—¶ä¼šå‡ºç°<strong>å¤§æ•°åƒå°æ•°</strong>çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼š16777216 + 1 = 16777216ï¼‰</li></ol><p><strong>æ³¨æ„ï¼Œè¿™ç§æƒ…å†µåªå‡ºç°åœ¨æµ®ç‚¹æ•°è¿ç®—ä¸­ï¼Œæ•´æ•°è¿ç®—ä¸ä¼šå‡ºç°</strong></p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;iostream&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">using</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> namespace</span><span style="--shiki-light:#383A42;--shiki-dark:#E5C07B;"> std</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(){</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    long</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i, n;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //intè¡¨ç¤º32ä½çš„æ•´æ•°ï¼Œlong è¡¨ç¤ºæ›´å¤§ä½çš„æ•´æ•°ï¼Œlong longä¼šä¿è¯è‡³å°‘64ä½çš„æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    double</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sum;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cin </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> n;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    sum </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> n; i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">--</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">i){</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //è¿™é‡Œforé‡‡ç”¨--iè€Œä¸æ˜¯++iå°±æ˜¯ä¸ºäº†é˜²æ­¢å¤§æ•°åƒå°æ•°çš„æƒ…å†µå‘ç”Ÿ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        sum </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.0</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">i;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //è¿™é‡Œå¿…é¡»æ˜¯1.0ï¼Œä¸èƒ½æ˜¯1ï¼Œå› ä¸ºè¿™æ˜¯æµ®ç‚¹æ•°é™¤æ³•ä¸æ˜¯æ•´æ•°é™¤æ³•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    cout </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sum </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> endl;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_21-int8å’Œfp8åœ¨ieee754æ ‡å‡†ä¸‹çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_21-int8å’Œfp8åœ¨ieee754æ ‡å‡†ä¸‹çš„åŒºåˆ«"><span>21. INT8å’ŒFP8åœ¨IEEE754æ ‡å‡†ä¸‹çš„åŒºåˆ«ï¼Ÿ</span></a></h3><table><thead><tr><th>ç±»å‹</th><th>æ€»ä½æ•°</th><th>ç¬¦å·ä½</th><th>æŒ‡æ•°ä½</th><th>å°¾æ•°ä½</th><th>å…¸å‹åº”ç”¨åœºæ™¯</th></tr></thead><tbody><tr><td>INT8</td><td>8</td><td>1</td><td>0</td><td>7</td><td>é‡åŒ–æ¨ç†ã€å­˜å‚¨èŠ‚çœã€åµŒå…¥å¼è®¡ç®—</td></tr><tr><td>FP8</td><td>8</td><td>1</td><td>4 æˆ– 5</td><td>3 æˆ– 2</td><td>AI æ¨ç†åŠ é€Ÿã€ä½ç²¾åº¦è®­ç»ƒï¼ˆEdge TPU / GPU TensorCoreï¼‰</td></tr></tbody></table><h3 id="_22-int8å’Œfp8çš„ä¼˜åŠ£åŠ¿å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#_22-int8å’Œfp8çš„ä¼˜åŠ£åŠ¿å¯¹æ¯”"><span>22. INT8å’ŒFP8çš„ä¼˜åŠ£åŠ¿å¯¹æ¯”</span></a></h3><ol><li><p>äºŒè€…éƒ½æ˜¯ä¸ºæ¨¡å‹é‡åŒ–è€Œç”Ÿï¼Œfp8ç›¸å¯¹äºint8åœ¨ç²¾åº¦ä¸Šé¢ä¸å…·æœ‰ç†è®ºä¼˜åŠ¿ï¼Œå› ä¸º<strong>int8ä¸ºå‡åŒ€æ•°æ®ç±»å‹</strong>ï¼Œåœ¨å€¼åŸŸå†…éƒ½æ˜¯å‡åŒ€çš„ï¼Œæ•°å’Œæ•°ä¹‹é—´é—´éš”ä¸º1ï¼Œä½†<strong>fp8ä¸æ˜¯å‡åŒ€æ•°æ®ç±»å‹</strong>ï¼Œæ•°ä¸æ•°ä¹‹é—´é—´éš”ä¸å®šï¼Œä½†æ˜¯ä¸ªæ•°ä¸€å®šä¸º3ä¸ªï¼Œè¿™ä¹Ÿå¯¼è‡´äº†åœ¨æ•°<strong>å€¼å°çš„èŒƒå›´é‡Œé¢ï¼Œfp8çš„ç²¾åº¦ä¼˜äºint8ï¼Œä½†æ˜¯åœ¨æ•°å€¼åå¤§çš„èŒƒå›´é‡Œé¢ï¼Œint8ç²¾åº¦ä¼˜äºfp8</strong>ã€‚</p></li><li><p><strong>fp8å¯ä»¥ç”¨æ¥åšæ¨¡å‹è®­ç»ƒ</strong>ï¼ˆä¾‹å¦‚Deepseekå°±ä½¿ç”¨fp8ç²¾åº¦åšçš„è®­ç»ƒï¼‰ï¼Œå¹¶ä¸”fp8è®­ç»ƒçš„æ¨¡å‹å¯ä»¥<strong>ç›´æ¥ä½¿ç”¨fp8è¿›è¡Œæ¨ç†</strong>ã€‚<strong>Int8ä¸èƒ½ç”¨ä½œæ¨ç†</strong>å› ä¸ºå€¼åŸŸé‡Œé¢å…¨æ˜¯æ•´æ•°ï¼Œæ²¡æ³•æ±‚å¯¼ï¼Œä»è€Œæ²¡æ³•è®¡ç®—æ¢¯åº¦ã€‚</p></li><li><p>fp8é‡åŒ–ç†è®ºä¸Šç›¸å¯¹int8ä¸éœ€è¦æ ¡å‡†(calibration)ï¼Œç›´æ¥è®¾ç½®input scaleå’Œoutput scaleä¸º1å³å¯é‡åŒ–ï¼Œï¼ˆæ³¨æ„ï¼šå®é™…ä¸Šå¤šæ•°fp8é‡åŒ–é¡¹ç›®è¿˜æ˜¯åšäº†calibrationï¼‰ï¼Œint8éœ€è¦calibration</p></li></ol><h3 id="_23-attentionåŒ…å«å“ªäº›ç®—å­-ä½¿ç”¨pytorchæ­å»ºä¸€ä¸‹ã€‚" tabindex="-1"><a class="header-anchor" href="#_23-attentionåŒ…å«å“ªäº›ç®—å­-ä½¿ç”¨pytorchæ­å»ºä¸€ä¸‹ã€‚"><span>23. AttentionåŒ…å«å“ªäº›ç®—å­ï¼Ÿä½¿ç”¨pytorchæ­å»ºä¸€ä¸‹ã€‚</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn.functional </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> F</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> SimpleAttention</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">nn</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Module</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ## d_modelè¡¨ç¤ºhidden size, d_headè¡¨ç¤ºhead num</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ## å•å¤´æ³¨æ„åŠ›ï¼šhiddensize = head num;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    ## å¤šå¤´æ³¨æ„åŠ›ï¼šhiddensize = head num * headsize;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> d_model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> d_head</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.d_head </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> d_head</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.W_q </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(d_model, d_head) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">##å°†è¾“å…¥çš„hiddensizeç»´åº¦è½¬ä¸ºheadnumç»´åº¦ï¼Œè¿›è¡ŒAttentionè®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.W_k </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(d_model, d_head) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">##nn.Linear(è¾“å…¥ç»´åº¦, è¾“å‡ºç»´åº¦, bias=Trueé»˜è®¤)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.W_v </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(d_model, d_head)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.W_o </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(d_head, d_model) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">##Attentionè®¡ç®—åçš„ç»“æœï¼ˆç»´åº¦ä¸º d_headï¼‰æ˜ å°„å›åŸå§‹æ¨¡å‹ç»´åº¦ d_model</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> forward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        x:    [bs, seq_len, d_model]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        mask: [seq_len, seq_len] æ³¨æ„åŠ›åˆ†æ•°æ˜¯ä¸€ä¸ª seq*seq çš„çŸ©é˜µï¼Œå› æ­¤æ©ç çŸ©é˜µè¦å’Œå®ƒshapeä¸€è‡´</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        bs, seq_len, _ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x.shape</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## QKV linear</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        Q </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">W_q</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, d_model] -&gt; [bs, seq_len, d_head]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        K </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">W_k</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, d_model] -&gt; [bs, seq_len, d_head]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        V </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">W_v</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, d_model] -&gt; [bs, seq_len, d_head]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## RoPE</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        Q, K </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> apply_rope</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Q, K, cos, sin)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## Q*(K^T) / sqrt(d_head)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        attn_socres </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">matmul</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(Q, K.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.d_head </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">**</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, seq_len]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # -2 -1è¡¨ç¤ºKçš„å€’æ•°ç¬¬ä¸€å’Œç¬¬äºŒç»´åº¦ä¹Ÿå°±æ˜¯[seq_len, d_head],transposeä¸º[d_head, seq_len]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## Mask</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> mask </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">is</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> not</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> None</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            attn_socres </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> attn_socres.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">masked_fill</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(causal_mask </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;-inf&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, seq_len]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # causal_maskçŸ©é˜µshapeä¸attn_socresä¸€æ ·ï¼Œéœ€è¦æ©ç çš„åœ°æ–¹å€¼ä¸º0ï¼Œä¸éœ€è¦çš„åœ°æ–¹å€¼ä¸º1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # masked_fillå‡½æ•°æ˜¯å°†attn_socresçŸ©é˜µä¸­å’Œcausal_maskçŸ©é˜µä¸º0çš„ä½ç½®ç›¸åŒçš„ä½ç½® å°†å…¶å€¼ç½®ä¸º-inf</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # softmaxä¼šå°†-infçš„å€¼çš„æ¦‚ç‡ç®—ä¸º0ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆMaskè¦æ”¾åœ¨Softmaxå‰é¢çš„åŸå› ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## Softmax</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        attn_weights </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">softmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(attn_socres, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, seq_len]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # dim=-1è¡¨ç¤ºå¯¹æœ€åä¸€ä¸ªç»´åº¦è¿›è¡Œsoftmaxï¼Œæ¯ä¸€è¡Œï¼ˆæ¯”å¦‚ç¬¬ i è¡Œï¼‰è¡¨ç¤ºï¼šç¬¬iä¸ªtokenå¯¹æ‰€æœ‰å…¶ä»–tokençš„åŸå§‹æ³¨æ„åŠ›åˆ†æ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # æ‰€ä»¥è¦åœ¨æ¯è¡Œå†…éƒ¨åš softmax â€”â€” ä¹Ÿå°±æ˜¯åœ¨æœ€åä¸€ä¸ªç»´åº¦ï¼ˆåˆ—æ–¹å‘ï¼‰ä¸Šæ“ä½œã€‚</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        ## O = attn_weights * K</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">matmul</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(attn_weights, V) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, d_head]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">W_o</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#[bs, seq_len, d_model]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> output</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ======================</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä½¿ç”¨ç¤ºä¾‹</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ======================</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    d_model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    d_head </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 64</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    seq_len </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    bs </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> SimpleAttention</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(d_model, d_head)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rand</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(bs, seq_len, d_model)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    out </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è¾“å…¥å½¢çŠ¶:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, x.shape)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è¾“å‡ºå½¢çŠ¶:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, out.shape)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å››-x86cpuä½“ç³»ç»“æ„" tabindex="-1"><a class="header-anchor" href="#å››-x86cpuä½“ç³»ç»“æ„"><span>å››. X86CPUä½“ç³»ç»“æ„</span></a></h2><p>CPUçš„è¿™äº›é—®é¢˜é—®åˆ°çš„æ¦‚ç‡æ¯”è¾ƒå°ï¼Œå¯èƒ½åªæœ‰ä¸€äº›åšç«¯ä¾§ARMæ¶æ„çš„å…¬å¸é—®é—®ã€‚</p><h3 id="_24-cpuä¸Šæœ‰å“ªäº›å¹¶è¡Œç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#_24-cpuä¸Šæœ‰å“ªäº›å¹¶è¡Œç­–ç•¥"><span>24. CPUä¸Šæœ‰å“ªäº›å¹¶è¡Œç­–ç•¥ï¼Ÿ</span></a></h3><ol><li>æŒ‡ä»¤çº§åˆ«å¹¶è¡Œï¼šæµæ°´çº¿ã€è¶…æ ‡é‡</li><li>çº¿ç¨‹çº§å¹¶è¡Œï¼šè¶…çº¿ç¨‹ã€å¤šæ ¸å¤šçº¿ç¨‹openMP</li><li>æ•°æ®çº§å¹¶è¡Œï¼šå¦‚SIMDå•æŒ‡ä»¤å¤šæ•°æ®ã€å‘é‡åŒ–</li></ol><h3 id="_25-cpuå’Œgpuæ¶æ„çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#_25-cpuå’Œgpuæ¶æ„çš„åŒºåˆ«"><span>25. CPUå’ŒGPUæ¶æ„çš„åŒºåˆ«ï¼Ÿ</span></a></h3><p>ä¸»è¦é’ˆå¯¹ä»¥ä¸‹å‡ ç‚¹å›ç­”å³å¯ï¼š</p><ol><li>æ ¸å¿ƒæ•°é‡ï¼šCPUæ ¸å¿ƒæ•°é‡å°‘ï¼ŒGPUæ ¸å¿ƒæ•°é‡å¤šï¼ˆGPUè¿˜æœ‰å¾ˆå¤šä¸“æœ‰çš„è®¡ç®—æ ¸å¿ƒæ¯”å¦‚TensorCoreï¼‰</li><li>å¹¶è¡Œç­–ç•¥ï¼šCPUä»¥24.é¢˜ä¸­ä¸‰å¤§å¹¶è¡Œç­–ç•¥ä¸ºä¸»ï¼ŒGPUåˆ™åªä»¥çº¿ç¨‹çº§å¹¶è¡Œä¸ºä¸»</li><li>ç‰‡ä¸Šå†…å­˜ï¼šCPUçš„ä¸‰çº§cacheå å¾ˆå¤§æ¯”ä¾‹ï¼ŒGPUçš„ç‰‡ä¸Šå†…å­˜åˆ™æ¯”è¾ƒå°</li><li>å¸¦å®½ï¼šCPUçš„å†…å­˜å¸¦å®½æ¯”è¾ƒå°ï¼ˆDDR5ï¼‰ï¼ŒGPUçš„å†…å­˜å¸¦å®½æ¯”è¾ƒå¤§ï¼ˆHBMï¼‰</li><li>CPUä»¥æ§åˆ¶å¯†é›†å‹ä»»åŠ¡ä¸ºä¸»ï¼ŒGPUä»¥è®¡ç®—å¯†é›†å‹ä»»åŠ¡ä¸ºä¸»</li><li>CPUæ˜¯ä»¥ä½å»¶è¿Ÿä¸ºä¸­å¿ƒçš„ï¼ŒGPUæ˜¯ä»¥é«˜ååé‡ä¸ºä¸­å¿ƒçš„</li></ol><h3 id="_26-cpuæ˜¯å¦‚ä½•ä½“ç°è‡ªå·±æ˜¯ä»¥ä½å»¶è¿Ÿä¸ºä¸­å¿ƒçš„" tabindex="-1"><a class="header-anchor" href="#_26-cpuæ˜¯å¦‚ä½•ä½“ç°è‡ªå·±æ˜¯ä»¥ä½å»¶è¿Ÿä¸ºä¸­å¿ƒçš„"><span>26. CPUæ˜¯å¦‚ä½•ä½“ç°è‡ªå·±æ˜¯ä»¥ä½å»¶è¿Ÿä¸ºä¸­å¿ƒçš„ï¼Ÿ</span></a></h3><ol><li><strong>æµæ°´çº¿</strong>ï¼šæ¶ˆé™¤æŒ‡ä»¤é—´ä¾èµ–å…³ç³»ï¼Œä½¿å¾—æŒ‡ä»¤ä¸æŒ‡ä»¤é—´å¯ä»¥overlapï¼Œä»è€Œå‡å°‘æŒ‡ä»¤æ‰§è¡Œçš„å»¶è¿Ÿï¼›</li><li><strong>åˆ†æ”¯é¢„æµ‹</strong>ï¼šè·³è¿‡if elseåˆ¤æ–­è¯­å¥ï¼Œæ ¹æ®é¢„æµ‹ç»“æœç›´æ¥æ‰§è¡Œif body æˆ–è€…else bodyï¼›</li><li><strong>é¢„å–</strong>ï¼šé¢„å…ˆåŠ è½½æŒ‡ä»¤å’Œæ•°æ®åˆ°cacheä¸­ï¼Œå‡å°‘ç­‰å¾…æ—¶é—´ï¼›</li><li><strong>æŒ‡ä»¤èåˆ</strong>:ä¾‹å¦‚å°†mulå’Œaddèåˆæˆä¸€ä¸ªæŒ‡ä»¤fma(fused multiply-add)ï¼Œfmaçš„å»¶è¿Ÿè¦å°äºmulä¸addçš„å»¶è¿Ÿä¹‹å’Œ</li><li>é¢ç§¯è¶…å¤§çš„L1 ã€L2 ã€L3 cacheï¼Œå¯ä»¥ç¼“å­˜æ›´å¤šçš„æŒ‡ä»¤å’Œæ•°æ®ï¼Œå‡å°‘å†…å­˜è®¿é—®çš„å»¶è¿Ÿï¼›</li><li><strong>ä¹±åºæ‰§è¡Œ</strong>ï¼šæ ¹æ®æŒ‡ä»¤çš„ä¾èµ–å…³ç³»ï¼Œä¹±åºæ‰§è¡ŒæŒ‡ä»¤ï¼Œä»è€Œæé«˜æŒ‡ä»¤çš„å¹¶è¡Œåº¦ï¼›ä»¥ä¸‹é¢ä»£ç ä¸ºä¾‹</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> MUL R9, R10, R11  ; R9 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R10 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R11</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> MUL R12, R9, R11  ; R12 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R9 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R11</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ADD R13, R10, R11  ; R13 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R10 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R11</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ADD R13, R10, R11  ; R14 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R9 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> R11</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//CPUä¼šè¯†åˆ«åˆ°1.2.ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå®ƒå¯èƒ½ä¼šå…ˆæ‰§è¡Œ3.ï¼ˆä¹±åºæ‰§è¡Œï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//CPUè¯†åˆ«åˆ°4.æ˜¯ä¸€ä¸ªR10å’ŒR11çš„ä¹˜æ³•+R9çš„åŠ æ³•ï¼Œå®ƒå¯èƒ½ä¼šè¿›è¡Œèåˆä¸ºfmaï¼ˆæŒ‡ä»¤èåˆï¼‰</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_27-cpuçš„å­˜å‚¨å±‚æ¬¡æ¶æ„æ˜¯æ€æ ·çš„-å®ƒä»¬çš„é€Ÿåº¦ã€å®¹é‡å¦‚ä½•" tabindex="-1"><a class="header-anchor" href="#_27-cpuçš„å­˜å‚¨å±‚æ¬¡æ¶æ„æ˜¯æ€æ ·çš„-å®ƒä»¬çš„é€Ÿåº¦ã€å®¹é‡å¦‚ä½•"><span>27. CPUçš„å­˜å‚¨å±‚æ¬¡æ¶æ„æ˜¯æ€æ ·çš„ï¼Ÿå®ƒä»¬çš„é€Ÿåº¦ã€å®¹é‡å¦‚ä½•ï¼Ÿ</span></a></h3><p>ç»“æ„ç”±å¤–åˆ°å†…æ˜¯ï¼šå†…å­˜-&gt;L3 cache-&gt;L2 cache-&gt;L1 cache-&gt;å¯„å­˜å™¨</p><p>é€Ÿåº¦ï¼šç”±å¤–åˆ°å†…å˜å¿«</p><p>å®¹é‡ï¼šç”±å¤–åˆ°å†…å˜å°</p><h3 id="_28-cpu-cacheçš„ä¸‰ç§ç»„ç»‡ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_28-cpu-cacheçš„ä¸‰ç§ç»„ç»‡ç»“æ„"><span>28. CPU cacheçš„ä¸‰ç§ç»„ç»‡ç»“æ„ï¼Ÿ</span></a></h3><ol><li>ç›´æ¥æ˜ å°„ï¼šæ¯ä¸ªä¸»å­˜å—åªèƒ½æ˜ å°„åˆ° cache ä¸­å”¯ä¸€çš„ä¸€ä¸ªä½ç½®ã€‚ç»“æ„ç®€å•ï¼ŒæŸ¥æ‰¾å¿«ã€‚ä½†å†²çªç‡é«˜ï¼Œä¸åŒçš„å†…å­˜å—å¯èƒ½ç«äº‰åŒä¸€ä¸ª cache è¡Œã€‚</li><li>å…¨ç›¸è”ï¼šä¸»å­˜ä¸­çš„ä»»æ„å—å¯ä»¥æ”¾åˆ° cache çš„ä»»æ„ä½ç½®ã€‚å†²çªç‡æœ€ä½ï¼Œå‘½ä¸­ç‡é«˜ã€‚ä½†ç¡¬ä»¶å¼€é”€å¤§ï¼ŒæŸ¥æ‰¾æ…¢ã€‚</li><li>ç»„ç›¸è”ï¼šæŠ˜ä¸­æ–¹æ¡ˆï¼ŒæŠŠ cache åˆ†æˆè‹¥å¹²ç»„ï¼Œæ¯ç»„å†…æœ‰å¤šè¡Œï¼ˆç§°ä¸ºâ€œè·¯â€ï¼‰ã€‚ä¸»å­˜å—å…ˆé€šè¿‡ æ¨¡è¿ç®—å®šä½åˆ°æŸä¸€ç»„ï¼Œå†åœ¨ç»„å†…â€œå…¨ç›¸è”â€æŸ¥æ‰¾ã€‚</li></ol><p><strong>ç›´æ¥æ˜ å°„ã€å…¨ç›¸è”å’Œç»„ç›¸è”ã€‚ç›´æ¥æ˜ å°„ç®€å•ä½†å†²çªå¤šï¼›å…¨ç›¸è”å‘½ä¸­ç‡é«˜ä½†ç¡¬ä»¶å¤æ‚ï¼›ç»„ç›¸è”æ˜¯æŠ˜ä¸­æ–¹æ¡ˆï¼Œç°ä»£ CPU å¤§å¤šé‡‡ç”¨ç»„ç›¸è”ç»“æ„ã€‚</strong></p><h3 id="_29-cpuä¼˜åŒ–è®¿å­˜çš„æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#_29-cpuä¼˜åŒ–è®¿å­˜çš„æ–¹æ³•"><span>29. CPUä¼˜åŒ–è®¿å­˜çš„æ–¹æ³•ï¼Ÿ</span></a></h3><ul><li>ä¸‰çº§cacheï¼ˆç»å¸¸è¯»å–çš„æ•°æ®å°±æ”¾åœ¨L1 cacheä¸­ï¼‰</li><li>é¢„è¯»å–ï¼šå–æœªæ¥å¯èƒ½ä¼šç”¨åˆ°çš„æ•°æ®åˆ°cacheä¸Šã€‚GPUéœ€è¦é€šè¿‡è½¯ä»¶çš„æ‰‹æ®µå®ç°prefetchï¼Œä½†cpuæœ‰ä¸“é—¨çš„ç¡¬ä»¶å•å…ƒæ¥å®ç°prefetchï¼ˆä½†æ˜¯è¿™ä¸ªæˆ‘ä»¬æ— æ³•æ§åˆ¶ï¼Œè¿™æ˜¯cpuçš„æœºå¯†ï¼‰</li><li>è®¿å­˜è¿ç»­ï¼ˆè®¿å­˜ä¸è¿ç»­æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´cache missï¼Œå°±åªèƒ½ä»å†…å­˜ä¸Šè¯»äº†ï¼Œæ€§èƒ½ä¸‹é™ï¼‰</li></ul><p>CPUåªè¦ä¿è¯è®¿å­˜è¿ç»­å°±å¥½ï¼Œä¸éœ€è¦åƒGPUä¸€æ ·è¿˜å¾—è€ƒè™‘é‚£äº›bank conflicté‚£äº›çš„ã€‚</p><h3 id="_30-ä»¥ä¸‹ä»£ç ä½ è§‰å¾—å­˜åœ¨å“ªäº›é—®é¢˜-è¯¥å¦‚ä½•ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#_30-ä»¥ä¸‹ä»£ç ä½ è§‰å¾—å­˜åœ¨å“ªäº›é—®é¢˜-è¯¥å¦‚ä½•ä¼˜åŒ–"><span>30. ä»¥ä¸‹ä»£ç ä½ è§‰å¾—å­˜åœ¨å“ªäº›é—®é¢˜ï¼Ÿè¯¥å¦‚ä½•ä¼˜åŒ–ï¼Ÿ</span></a></h3><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">std::</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">vector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">N</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> N; i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">++</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //åªèƒ½ä¸²è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    acc </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[i];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //é—®é¢˜åœ¨è¿™é‡Œï¼Œi=1çš„è®¡ç®—å¿…é¡»è¦ç­‰å¾…i=0çš„è®¡ç®—å®Œæˆï¼ŒåŒç†i=2...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//ä¼˜åŒ–åï¼ˆç›¸æ¯”ä¸Šé¢ä¼˜åŒ–å‰ï¼Œç†è®ºæ˜¯å¿«åå€ï¼Œå®é™…å¤§æ¦‚å¿«8ã€9å€å·¦å³ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">//=&gt;CSAPP ç¬¬äº”ç« </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">std::</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">vector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">N</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc0 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //å…ˆå®šä¹‰10ä¸ªå˜é‡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">float</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc3 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">f</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> N; i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ¯åä¸ªè¿­ä»£è¿›è¡Œå±•å¼€ï¼Œåä¸ªåŠ æ³•å¹¶è¡Œèµ·æ¥ï¼ˆè¶…æ ‡é‡ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      acc0 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[i];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      acc1 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> //æ­¤æ—¶acc1ä¸ä¾èµ–acc0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      acc2 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      acc3 </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[i</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">      ...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å‡è®¾åŠ æ³•å»¶è¿Ÿæ˜¯äº”ä¸ªå‘¨æœŸï¼ˆå‡è®¾åŠ æ³•å‘å°„ç«¯å£æœ‰ä¸¤ä¸ªï¼Œ0å’Œ1ï¼‰ï¼Œç»˜åˆ¶ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><figure><img src="/Notes/assets/img/30.58785ea1.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>åœ¨ç¬¬ä¸€ä¸ªå‘¨æœŸçš„æ—¶å€™ï¼Œä¸¤ä¸ªç«¯å£ä¼šå‘å°„ä¸¤æ¡åŠ æ³•æŒ‡ä»¤ï¼Œåˆ†åˆ«æ˜¯acc0 += in[0]å’Œacc1 += in[1]ï¼Œåœ¨ç¬¬äºŒä¸ªå‘¨æœŸçš„æ—¶å€™ï¼Œä¸¤ä¸ªç«¯å£ä¼šå‘å°„ä¸¤æ¡åŠ æ³•æŒ‡ä»¤ï¼Œåˆ†åˆ«æ˜¯acc2 += in[2]å’Œacc3 += in[3]ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>ç¬¬äºŒã€ä¸‰ã€å››å‘¨æœŸæ¯ä¸ªå‘¨æœŸåŒæ ·å‘å°„ä¸¤æ¡æŒ‡ä»¤ã€‚</p><p>åœ¨ç¬¬äº”ä¸ªå‘¨æœŸï¼Œæœ€å…ˆå‘å°„çš„ä¸¤ä¸ªæŒ‡ä»¤å°±æ‰§è¡Œå®Œæˆäº†ï¼Œæ­¤æ—¶æŒ‡ä»¤å¹¶è¡Œæ•°é‡ä¸ºæœ€å¤§2 * 5 = 10æ¡ã€‚<br> ä¹Ÿæ˜¯<strong>ä»ç¬¬äº”ä¸ªå‘¨æœŸå¼€å§‹ï¼Œï¼ˆå¦‚æœä¹‹åç»§ç»­å‘å°„æŒ‡ä»¤ä¸åœæ­¢çš„è¯ï¼‰cpuçš„åŠ æ³•ç®—åŠ›ä»ç¬¬äº”ä¸ªå‘¨æœŸèµ·å°±æ‰“æ»¡äº†</strong>ã€‚</p><h3 id="_31-cpuã€gpuçš„å³°å€¼ç®—åŠ›å¦‚ä½•è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#_31-cpuã€gpuçš„å³°å€¼ç®—åŠ›å¦‚ä½•è®¡ç®—"><span>31. CPUã€GPUçš„å³°å€¼ç®—åŠ›å¦‚ä½•è®¡ç®—ï¼Ÿ</span></a></h3><p>CPUï¼š</p><p><strong>å• CPU ç®—åŠ› = CPU æ ¸æ•° * å•æ ¸ä¸»é¢‘ * æ¯å‘¨æœŸè®¡ç®—æ“ä½œæ•°</strong></p><p>GPUï¼šï¼ˆä»¥A100ä¸ºä¾‹ï¼‰</p><figure><img src="/Notes/assets/img/31_1.67a28328.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>1.A100 <strong>fp16</strong> GPU CUDA coreç®—åŠ› = <strong>CUDA coreä¸ªæ•° * GPUé¢‘ç‡ * å•ä¸ªcuda coreæ¯å‘¨æœŸè®¡ç®—æ“ä½œæ•°</strong> = [108ï¼ˆSMæ•°é‡ï¼‰ * 256ï¼ˆæ¯SMçš„fp16æŒ‡ä»¤ååï¼‰]* [1.41 * e9 ï¼ˆæ¯ç§’å‘¨æœŸæ•°ï¼‰] * [2ï¼ˆä¹˜åŠ )]= 78TFLOPS</p><p>2.A100 fp32 GPU CUDA coreç®—åŠ› = CUDA coreä¸ªæ•° * GPUé¢‘ç‡ * å•ä¸ªcuda coreæ¯å‘¨æœŸè®¡ç®—æ“ä½œæ•° = [108ï¼ˆSMæ•°é‡ï¼‰ * 64ï¼ˆæ¯SMçš„fp32æŒ‡ä»¤åå)] * [1.41 * e9] * [2ï¼ˆä¹˜åŠ )] = 19.5TFLOPS</p><p>3.A100 fp16 GPU tensor coreç®—åŠ› = tensor coreä¸ªæ•° * GPUé¢‘ç‡ * å•ä¸ªtensor coreæ¯å‘¨æœŸè®¡ç®—æ“ä½œæ•° = [108ï¼ˆSMæ•°é‡ï¼‰* 4ï¼ˆtensorcoreæ•°é‡æ¯SMï¼‰] * [1.41 * e9] * [256ï¼ˆæŒ‡ä»¤/å‘¨æœŸï¼‰ * 2ï¼ˆä¹˜åŠ )] = 312TFLOPS</p><figure><img src="/Notes/assets/img/31_3.9d7169a4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_32-cpuæµæ°´çº¿çº§æ•°æ˜¯å¦è¶Šå¤šè¶Šå¥½" tabindex="-1"><a class="header-anchor" href="#_32-cpuæµæ°´çº¿çº§æ•°æ˜¯å¦è¶Šå¤šè¶Šå¥½"><span>32. CPUæµæ°´çº¿çº§æ•°æ˜¯å¦è¶Šå¤šè¶Šå¥½ï¼Ÿ</span></a></h3><p>ä¸æ˜¯ï¼Œçº§æ•°è¿‡å¤šä¼šé€ æˆä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li>çº§ä¸çº§ä¹‹é—´çš„ç´§å‡‘ç¨‹åº¦å¾ˆéš¾æ§åˆ¶ï¼Œè¿™ä¼šé€ æˆçº§ä¸çº§é—´çš„ç©ºéš™ï¼Œä¿—ç§°æµæ°´çº¿æ°”æ³¡(bubble)</li><li>æ¯ä¸€çº§éƒ½éœ€è¦ç‹¬ç«‹çš„ç”µè·¯å•å…ƒï¼ˆä¾‹å¦‚30.é¢˜ä¸­çš„ä¸åŒé¢œè‰²å¯¹åº”äºä¸åŒçš„ç‹¬ç«‹ç”µè·¯å•å…ƒï¼‰ï¼Œè¿™ä¼šæå¤§å¢å¤§èŠ¯ç‰‡é¢ç§¯ï¼Œæ—¶åºç”µè·¯ä¹Ÿä¼šéš¾ä»¥è®¾è®¡</li><li>å¯¹compilerçš„è¦æ±‚ä¹Ÿä¼šå¢é«˜ï¼Œå› ä¸ºéœ€è¦compilerç”Ÿæˆæ›´é«˜è´¨é‡çš„ä»£ç ä»¥å‡å°æµæ°´çº¿æ°”æ³¡</li><li>å¦‚æœä¸ç”¨compilerï¼Œè‡ªå·±æ‰‹åŠ¨æ’å¸ƒæµæ°´çº¿ï¼Œé‚£ä¹ˆè¿™ä¸ªæ’å¸ƒçš„éš¾åº¦ä¹Ÿæ˜¯æå¤§çš„ã€‚</li></ol><h2 id="äº”-gpuä½“ç³»ç»“æ„ä¸cudaç¼–ç¨‹" tabindex="-1"><a class="header-anchor" href="#äº”-gpuä½“ç³»ç»“æ„ä¸cudaç¼–ç¨‹"><span>äº”. GPUä½“ç³»ç»“æ„ä¸CUDAç¼–ç¨‹</span></a></h2><h3 id="_33-ç»™ä¸€ä¸ªcuda-kernelå¦‚ä½•åˆ†é…blockå’Œthreadæ•°-å¦‚ä½•å–åˆ°æœ€ä¼˜çš„blockå’Œthreadæ•°" tabindex="-1"><a class="header-anchor" href="#_33-ç»™ä¸€ä¸ªcuda-kernelå¦‚ä½•åˆ†é…blockå’Œthreadæ•°-å¦‚ä½•å–åˆ°æœ€ä¼˜çš„blockå’Œthreadæ•°"><span>33. ç»™ä¸€ä¸ªCUDA kernelå¦‚ä½•åˆ†é…blockå’Œthreadæ•°ï¼Ÿå¦‚ä½•å–åˆ°æœ€ä¼˜çš„blockå’Œthreadæ•°ï¼Ÿ</span></a></h3><figure><img src="/Notes/assets/img/33.530d0bd4.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æœ€ä¼˜çš„blockæ•°é‡å’Œthreadæ•°é‡å¾ˆéš¾ä¸€æ¬¡æ€§ç¡®å®šï¼Œä¸€èˆ¬éœ€è¦å€ŸåŠ©Nsight computeæ¥åˆ†æoccupancy</p><p>ä»¥ä¸‹æ˜¯ä¸€äº›å®æˆ˜ç»éªŒï¼š</p><p>å¯ä»¥<strong>å…ˆæ ¹æ®æ•°æ®çš„shapeå°†blockå’Œthreadæ•°åˆ†é…åˆ°ä¸€ä¸ªå¥½å†™ä»£ç çš„ç¨‹åº¦</strong>ï¼Œä¾‹å¦‚æ•°æ®æ˜¯[1024*1024]ï¼Œé‚£æˆ‘å°±å¯ä»¥åˆ†é…1024ä¸ªblockå¤„ç†1024è¡Œï¼Œ256/512/1024ä¸ªthreadå¤„ç†ä¸€åˆ—ï¼Œè¿™æ ·å†™ä»£ç ä¼šéå¸¸æ–¹ä¾¿ã€‚ï¼ˆè‡³äºè¿™ä¸‰ä¸ªthreadå…·ä½“å–å“ªä¸ªå¥½ï¼Œå¯¹äºä¸€èˆ¬çš„ç®—å­æ¥è¯´æ²¡å•¥å·®åˆ«ï¼Œå¯èƒ½åªå¯¹Gemmä¼šå½±å“å¤§ç‚¹ï¼‰</p><p>å¯¹äº<strong>threadæ•°é‡</strong>ï¼Œæœ‰ä¸ªå¿…è¦æ¡ä»¶ï¼šä¸€ä¸ª<strong>kernelçš„blockDimåº”è¯¥è‡³å°‘&gt;=è¯¥GPUçš„ä¸€ä¸ªSMçš„(æœ€å¤§çº¿ç¨‹æ•°/blockæ•°é‡)</strong>ã€‚ä¾‹å¦‚ï¼Œå¯¹äº3090æ˜¾å¡ï¼Œå®ƒä¸€ä¸ªSMä¸Šçš„æœ€å¤§çº¿ç¨‹æ•°ä¸º1536ï¼Œæœ€å¤§blockæ•°ä¸º16ï¼Œåˆ™cuda kernelçš„blockDimè‡³å°‘åº”è¯¥å¤§äº1536 / 16 = 96ã€‚å¦åˆ™ï¼Œæ— æ³•åœ¨ç†è®ºä¸Šè¾¾åˆ°100%çš„Occupancyã€‚ï¼ˆå ç”¨ç‡ä¹Ÿä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œå…¶å®å¤§äº70%å°±å·®ä¸å¤šäº†ï¼Œå†å¾€ä¸Škernelçš„æ€§èƒ½å°±å’Œå ç”¨ç‡å…³ç³»ä¸å¤§äº†ï¼‰</p><p>å¯¹äº<strong>blockæ•°é‡</strong>ï¼Œçœ‹çœ‹occupancyï¼Œçœ‹çœ‹full waveæ•°é‡å’Œtail waveï¼Œæ ¹æ®è¿™äº›metricæ¥è°ƒæ•´blockæ•°é‡ï¼Œä½¿å¾—<strong>full waveå°½å¯èƒ½å¤šï¼Œtail waveä¸­çš„blockæ•°é‡ä¹Ÿå°½å¯èƒ½å¤šï¼Œoccupancyå°½å¯èƒ½å¤§</strong>ï¼Œå¯¹æ­¤cudaä¹Ÿæä¾›äº†ä¸€äº›APIæ¥è®¡ç®—ä½¿å¾—occupancyæœ€å¤§çš„blockæ•°é‡ã€‚</p><p><em>å›¾ä¸­ï¼Œå·¦ä¾§çš„full waveä¸º2ï¼Œå æ¯”ä¸º2/3ï¼Œtail waveä¸­åªæœ‰ä¸€ä¸ªblockï¼Œå æ¯”ä¸º1/4ï¼Œè¿™ä¿©çš„å æ¯”éƒ½ä¸é«˜ï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´blockæ•°é‡ï¼›è°ƒæ•´åå³ä¾§çš„full waveå æ¯”ä¸º4/5ï¼Œtail waveå æ¯”ä¸º2/4ï¼Œè¿™ä¿©çš„å æ¯”éƒ½é«˜äº†ï¼Œå› æ­¤å¯¹åº”kernelçš„æ€§èƒ½ä¹Ÿä¼šæ›´å¥½</em></p><figure><img src="/Notes/assets/img/33_2.c47c1d4f.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>ç©¶æç»éªŒå…¬å¼ï¼š</strong>(è¿™æ ·è®¾ç½®ä¸€èˆ¬å·®ä¸äº†ï¼ŒGemmä¾‹å¤–ï¼Œå¾—ç‰¹è°ƒ)</p><ul><li>blockæ•°é‡è®¾ç½® 1~4å€çš„SMæ•°é‡</li><li>threadæ•°é‡è®¾ç½® 256/512</li></ul><h3 id="_34-å‡è®¾æœ‰nä¸ªæ•°-ä½†æ˜¯ä½ åˆ†é…äº†å°äºnçš„æ€»çº¿ç¨‹æ•°-æ­¤æ—¶å¯ä»¥å¤„ç†å®Œå…¨éƒ¨æ•°æ®å—-å¦‚æœå¯ä»¥-å¦‚ä½•å¤„ç†" tabindex="-1"><a class="header-anchor" href="#_34-å‡è®¾æœ‰nä¸ªæ•°-ä½†æ˜¯ä½ åˆ†é…äº†å°äºnçš„æ€»çº¿ç¨‹æ•°-æ­¤æ—¶å¯ä»¥å¤„ç†å®Œå…¨éƒ¨æ•°æ®å—-å¦‚æœå¯ä»¥-å¦‚ä½•å¤„ç†"><span>34. å‡è®¾æœ‰Nä¸ªæ•°ï¼Œä½†æ˜¯ä½ åˆ†é…äº†å°äºNçš„æ€»çº¿ç¨‹æ•°ï¼Œæ­¤æ—¶å¯ä»¥å¤„ç†å®Œå…¨éƒ¨æ•°æ®å—ï¼Ÿå¦‚æœå¯ä»¥ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ</span></a></h3><p>å¯ä»¥å¤„ç†ï¼Œä¼ªä»£ç å¦‚ä¸‹</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> blockIdx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">x</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> blockDim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">x</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> threadIdx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> N){</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    //do something</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    i </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">+=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> blockDim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">x</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> gridDim</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_35-shared-memory-bank-conflictçš„å®šä¹‰æ˜¯ä»€ä¹ˆæ ·çš„-æ˜“é”™" tabindex="-1"><a class="header-anchor" href="#_35-shared-memory-bank-conflictçš„å®šä¹‰æ˜¯ä»€ä¹ˆæ ·çš„-æ˜“é”™"><span>35. shared memory bank conflictçš„å®šä¹‰æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿï¼ˆæ˜“é”™ï¼‰</span></a></h3><p><strong>bank conflict</strong>ä»…å­˜åœ¨äº<strong>åŒä¸€phase</strong>çš„<strong>ä¸åŒslot</strong>ï¼ˆslotï¼šæ§½ï¼Œé’ˆå¯¹å•ä¸ªbankå†…çš„æ¦‚å¿µï¼Œä¸ä¸åŒbanké—´æ— å…³ï¼‰ä¹‹é—´ï¼Œè¯´å­˜åœ¨åŒä¸€warpçš„ä¸åŒçº¿ç¨‹é—´æ˜¯ä¸æ­£ç¡®çš„ã€‚</p><p>é‚£ä»€ä¹ˆæ˜¯åŒä¸€phaseï¼Ÿåˆ†ä¸‰ç§æƒ…å†µï¼šï¼ˆ1byte = 8bitsï¼‰</p><ol><li>æ¯ä¸ªçº¿ç¨‹è®¿é—®4bytes(ä¾‹å¦‚float)ï¼šä¸€ä¸ªwarpå†…çš„32ä¸ªçº¿ç¨‹å¤„äºåŒä¸€phase</li><li>æ¯ä¸ªçº¿ç¨‹è®¿é—®8bytes(ä¾‹å¦‚double)ï¼šä¸€ä¸ªwarpå†…çš„å‰16ä¸ªçº¿ç¨‹å¤„äºåŒä¸€phaseï¼Œå16ä¸ªçº¿ç¨‹å¤„äºå¦ä¸€ä¸ªphase</li><li>æ¯ä¸ªçº¿ç¨‹è®¿é—®16bytesï¼šä¸€ä¸ªwarpå†…çš„å‰8ä¸ªçº¿ç¨‹å¤„äºåŒä¸€phaseã€‚</li></ol><p>é—®ï¼šT0å’ŒT16è®¿é—®åŒä¸€slotä¼šä¸ä¼šbank conflictï¼Ÿç­”ï¼šä¸ä¼šï¼ˆT0å’ŒT16çº¿ç¨‹ä¸å±äºåŒä¸€ä¸ªphaseï¼‰</p><p>é—®ï¼šT0 T1è®¿é—®åŒä¸€slotä¼šä¸ä¼šbank conflictï¼Ÿç­”ï¼šä¸ä¼šï¼ˆè™½ç„¶T0å’ŒT1çº¿ç¨‹å±äºåŒä¸€ä¸ªphaseï¼Œä½†æ˜¯å®ƒä»¬è®¿é—®çš„æ˜¯bankä¸­çš„åŒä¸€slotï¼‰</p><p>é—®ï¼šT0 ç…§å¸¸è®¿é—®å½“å‰çš„0ï¼ŒT1ä¹Ÿè®¿é—®0ä¼šä¸ä¼šbank conflictï¼Ÿç­”ï¼šä¸ä¼šï¼ˆè¿™ä¸ªcaseå°±æ˜¯ä¸Šé¢è¿™ä¸ªé—®é¢˜çš„å…¸å‹ï¼Œæ­¤æ—¶ä¼šè§¦å‘å¹¿æ’­æ“ä½œï¼Œä¸ä¼šæœ‰conflictçš„ï¼‰</p><p>é—®ï¼šT0 ç…§å¸¸è®¿é—®å½“å‰çš„0ï¼ŒT1è®¿é—®åŸæœ¬T16è®¿é—®çš„é‚£å—æ•°æ®T16ä¼šä¸ä¼šbank conflictï¼Ÿç­”ï¼šä¼šï¼ˆæ­¤æ—¶T0å’ŒT1çº¿ç¨‹å±äºåŒä¸€ä¸ªphaseï¼Œä¸”å®ƒä»¬è®¿é—®çš„æ˜¯åŒä¸€bankä¸­çš„ä¸åŒslotï¼‰</p><p>ä¸‹å›¾ä¸­ç»¿è‰²ã€è“è‰²ä»£è¡¨äº†ä¸¤ä¸ªphaseï¼ˆå¯¹åº”äºæƒ…å†µ2.ï¼‰ï¼Œè€Œslotæ˜¯åŒä¸€bankå†…çš„æ¦‚å¿µï¼Œæ¯”å¦‚è¯´æ•°æ®å—0çš„å·¦åŠéƒ¨åˆ†å’Œ16çš„å·¦åŠéƒ¨åˆ†å®ƒä»¬å°±å±äºbank0çš„ä¸åŒslotã€‚<strong>æ— è®ºphaseå¦‚ä½•æ„æˆï¼Œä¸€ä¸ªbankä¸­åªå­˜ä¸€ä¸ªcachelineä¸­çš„4bytesæ•°æ®ï¼Œä¸€ä¸ªcachelineæ°¸è¿œéƒ½å›ºå®šæœ‰32ä¸ªbank</strong>ã€‚cachelineæ˜¯å›ºå®šå¤§å°çš„ï¼Œ128bytesï¼Œå› æ­¤æ‰æœ‰äº†åŒä¸€phaseçš„ä¸‰ç§æƒ…å†µï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯è¦åŒ¹é…ä¸Šcachelineçš„ã€‚</p><figure><img src="/Notes/assets/img/35.1cb4f1ea.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_36-å¦‚ä½•è§£å†³bank-conflict" tabindex="-1"><a class="header-anchor" href="#_36-å¦‚ä½•è§£å†³bank-conflict"><span>36. å¦‚ä½•è§£å†³bank conflictï¼Ÿ</span></a></h3><p><a href="https://zhuanlan.zhihu.com/p/4746910252" target="_blank" rel="noopener noreferrer">CUDA shared memoryé¿å…bank conflictçš„swizzlingæœºåˆ¶è§£æ</a><br> ä¸¤ç§æ–¹æ³•ï¼š</p><ul><li><p>æ–¹æ³•1ï¼špadding</p></li><li><p>æ–¹æ³•2ï¼šswizzling</p></li></ul><h2 id="å…­-å¤§æ¨¡å‹é‡åŒ–" tabindex="-1"><a class="header-anchor" href="#å…­-å¤§æ¨¡å‹é‡åŒ–"><span>å…­. å¤§æ¨¡å‹é‡åŒ–</span></a></h2><h2 id="ä¸ƒ-å¤§æ¨¡å‹æ¨ç†" tabindex="-1"><a class="header-anchor" href="#ä¸ƒ-å¤§æ¨¡å‹æ¨ç†"><span>ä¸ƒ. å¤§æ¨¡å‹æ¨ç†</span></a></h2><h2 id="å…«-leetcode" tabindex="-1"><a class="header-anchor" href="#å…«-leetcode"><span>å…«. Leetcode</span></a></h2><p>å‡ ä¸ªå¿«é€Ÿæ’åºå­¦ä¸€ä¸‹</p></div><!----><!----><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/your-username/your-repo/edit/main/src/zh/posts/interview.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">æœ€è¿‘æ›´æ–°ï¼š</span><time class="vp-meta-info" datetime="2025-08-22T03:04:48.000Z" data-allow-mismatch>2025/8/22 03:04</time></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: gaoyuqing536@gmail.com">yqgao</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/Notes/zh/posts/Inference.html" aria-label="InferenceæœåŠ¡çš„ä¸€äº›å¸¸è§é—®é¢˜"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><!---->InferenceæœåŠ¡çš„ä¸€äº›å¸¸è§é—®é¢˜</div></a><a class="route-link auto-link next" href="/Notes/zh/posts/MoE.html" aria-label="MoE"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">MoE<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">é»˜è®¤é¡µè„š</div><div class="vp-copyright">Copyright Â© 2025 GYQ </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/Notes/assets/js/runtime~app.92bd03ff.js" defer></script><script src="/Notes/assets/js/2047.24e5abc8.js" defer></script><script src="/Notes/assets/js/app.56c173b4.js" defer></script>
  </body>
</html>
