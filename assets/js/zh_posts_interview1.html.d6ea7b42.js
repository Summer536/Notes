"use strict";(self.webpackChunkvuepress=self.webpackChunkvuepress||[]).push([[8563],{3387:(e,a,t)=>{t.r(a),t.d(a,{comp:()=>o,data:()=>s});var n=t(641);const r=t.p+"assets/img/T_5.276a6110.png",p={},o=(0,t(6262).A)(p,[["render",function(e,a){return(0,n.uX)(),(0,n.CE)("div",null,[a[0]||(a[0]=(0,n.Lk)("h1",{id:"八股面试",tabindex:"-1"},[(0,n.Lk)("a",{class:"header-anchor",href:"#八股面试"},[(0,n.Lk)("span",null,"八股面试")])],-1)),a[1]||(a[1]=(0,n.Lk)("h2",{id:"简介",tabindex:"-1"},[(0,n.Lk)("a",{class:"header-anchor",href:"#简介"},[(0,n.Lk)("span",null,"简介")])],-1)),a[2]||(a[2]=(0,n.Lk)("p",null,"记录一些面试问题。",-1)),(0,n.Q3)(" more "),a[3]||(a[3]=(0,n.Fv)('<h2 id="小米-大模型推理优化工程师-一面-09-12" tabindex="-1"><a class="header-anchor" href="#小米-大模型推理优化工程师-一面-09-12"><span>小米-大模型推理优化工程师（一面，09.12）</span></a></h2><h3 id="_1-有没有了解过qnn推理引擎" tabindex="-1"><a class="header-anchor" href="#_1-有没有了解过qnn推理引擎"><span>1. 有没有了解过QNN推理引擎？</span></a></h3><p>QNN (Qualcomm Neural Network) 主要是基于一些 Qualcomm Snapdragon 平台（CPU / GPU / DSP / NPU）的一个Ai推理引擎，执行一些轻量级深度学习模型（大模型执行不了）。</p><h3 id="_2-计算流体力学会用到高性能计算的东西吗" tabindex="-1"><a class="header-anchor" href="#_2-计算流体力学会用到高性能计算的东西吗"><span>2. 计算流体力学会用到高性能计算的东西吗？</span></a></h3><p>是的，在CFD中用到的HPC内容主要有：<strong>并行计算</strong>，<strong>稀疏矩阵运算优化</strong>，<strong>分布式通信与负载均衡</strong>，其实这个专业和数学也没啥区别了，天天解方程。</p><p><strong>与大模型推理相比这个HPC的区别在哪里？</strong></p><ol><li><p>计算模式不同：<strong>PDE + 高精度</strong>， 大模型是<strong>张量、矩阵 + 低精度</strong></p></li><li><p>数据依赖不同：CFD 的<strong>时间步长更新通常是强依赖</strong>的，前一步必须算完才能算下一步，难以完全解耦。大模型推理里，Prefill 阶段可以大批量并行，但 Decode 阶段是自回归的，计算依赖不同。</p></li><li><p>优化重点不同：CFD 优化常在稀疏矩阵运算、迭代收敛效率和通信负载上。大模型推理优化更关注矩阵乘法效率（GEMM + Tensor Core）、KV Cache管理、量化/压缩技术。</p></li></ol><h3 id="_3-项目中的推理框架的整体架构和思路是什么" tabindex="-1"><a class="header-anchor" href="#_3-项目中的推理框架的整体架构和思路是什么"><span>3. 项目中的推理框架的整体架构和思路是什么？</span></a></h3><p>整体架构是以：CUDA内核层 + Prefill/Decoder 和FFN层 + model层，三层嵌套的。</p><ol><li>cuda内核层：embedding、linear、RMSnorm、softmax、RoPE、SwiGLU这些底层cuda kernel，并且采用了算子融合、向量化读取等手段进行内核优化；</li><li>神经网络层：Prefill层是以attention计算+mask部分组成； Decoder layer是比前者少了一个mask； FFN layer的话就是一个gate up、Swiglu以及down linear投影输出；</li><li>model层：输入处理（Tokenizer + Embedding） + if firsttoken：Prefill else decoder + 输出处理（LM头线性变换 + TopK采样）</li><li>权重处理：权重只加载一次，在整个推理过程中复用；通过指针传递到各个layer中，然后再传递到各个kernel中使用。</li></ol><h3 id="_4-项目中的分级内存管理策略是什么" tabindex="-1"><a class="header-anchor" href="#_4-项目中的分级内存管理策略是什么"><span>4. 项目中的分级内存管理策略是什么？</span></a></h3><p>双池设计：大内存池(&gt;1MB)和小内存池(≤1MB)分别管理</p><p>延迟释放：释放的内存不立即归还OS，而是标记为可用</p><p>碎片管理：通过FreeSize跟踪小内存池碎片，超过1GB时清理</p><p><strong>哪些会用到大内存池，哪些会用到小内存池？</strong></p><p>大： kvcache、QKV weight、</p><p>小：计算结果的一些中间值</p><h3 id="_5-项目中针对kv-cache是如何做内存管理的呢" tabindex="-1"><a class="header-anchor" href="#_5-项目中针对kv-cache是如何做内存管理的呢"><span>5. 项目中针对kv cache是如何做内存管理的呢？</span></a></h3><p><strong>预分配策略</strong>：KV cache在模型初始化时一次性分配整个max_seq_len的空间（因此都在大内存池中）</p><p>内存复用：同一个cache缓冲区在整个推理过程中重复使用<br><img src="'+r+'" alt="" loading="lazy"></p><p><strong>kv cache如何做更新的呢？</strong></p><p>先计算指针的偏移量；</p><p>上下文阶段：一次性填充整个输入序列的KV值</p><p>生成阶段：增量更新，每次只更新一个token位置的KV值</p><h3 id="_6-框架里做了哪些算子融合" tabindex="-1"><a class="header-anchor" href="#_6-框架里做了哪些算子融合"><span>6. 框架里做了哪些算子融合？</span></a></h3><p>QKV bais + RoPE, attention计算的融合, FFN layer里面的Gate和up linear等等</p><p><strong>RoPE 为什么没有实现融合</strong><br> LLaMA2 的RoPE问题，它以64为单位进行的RoPE，没法进行向量化读取？</p><h3 id="_7-gemm的优化策略以及如何解决bank-conflict" tabindex="-1"><a class="header-anchor" href="#_7-gemm的优化策略以及如何解决bank-conflict"><span>7. GEMM的优化策略以及如何解决bank conflict？</span></a></h3><p>share mem + float4 + 双缓冲 + swlizzing（解决bank conflict）</p><h3 id="_8-实习经历的量化-做激活值的量化吗" tabindex="-1"><a class="header-anchor" href="#_8-实习经历的量化-做激活值的量化吗"><span>8. 实习经历的量化，做激活值的量化吗？</span></a></h3><p>在实习经历里，我主要做的是 权重量化（Weight Quantization）</p><p>因为激活值比较难量化：动态范围大，异常值多、精度敏感性强，比较难做优化。</p><h3 id="_9-nsight-compute和-nsight-system掌握程序如何-平时如何使用" tabindex="-1"><a class="header-anchor" href="#_9-nsight-compute和-nsight-system掌握程序如何-平时如何使用"><span>9. nsight-compute和 nsight-system掌握程序如何？平时如何使用？</span></a></h3><p><strong>NCU</strong>：</p><p>入门：能用 ncu --metrics 收集基本指标，如 FLOPS、内存带宽、warp 效率。</p><p>中级：会分析 occupancy、shared memory bank conflict、warp divergence 等问题，并能够定位 kernel 瓶颈。</p><p><strong>NSYS</strong></p><p>入门：能够捕获 timeline，看到 kernel 启动、数据传输、CPU-GPU 调度。</p><p>中级：分析 host 与 device 的 overlap，识别 kernel launch overhead、数据拷贝瓶颈。</p><h2 id="深信服科技" tabindex="-1"><a class="header-anchor" href="#深信服科技"><span>深信服科技</span></a></h2><h3 id="_1-hr电话-25-06-03-09-00" tabindex="-1"><a class="header-anchor" href="#_1-hr电话-25-06-03-09-00"><span>1. HR电话(25.06.03 09:00)</span></a></h3><ol><li><p>你们实验室是做这个方向的吗？</p><p>我们实验室分四个方向（计算流体（深度学习）、多相流、介观方法、高性能计算），其中之一就是做并行计算的。团队比较大，一个大导师带着二十多个人。目前有一个博士和两个硕士，博士是做并行计算（HPC-科学计算）的，做算法的。（下次这样说：博士是做算法和并行计算的，带我的博后是做深度学习的。整个方向比较的多学科交叉。之前的多GPU项目主要是博士师兄带着做，科研的方向主要由这个博后带着做。至于另一个硕士，她对这行没想法，一心考公。 大模型这方向确实不是我们的只要研究，推理加速这个是我的个人兴趣。）</p></li><li><p>带你的这个博士是第几年？</p><p>这个博士是第五年，马上要毕业了（今年冬天或者明年毕业）。</p></li></ol>',42))])}]]),s=JSON.parse('{"path":"/zh/posts/interview1.html","title":"八股面试","lang":"zh-CN","frontmatter":{"title":"八股面试","date":"2025-06-03T00:00:00.000Z","readingTime":600,"category":["笔记"],"tag":["八股面试"],"isOriginal":true,"description":"简介 记录一些面试问题。","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"八股面试\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-06-03T00:00:00.000Z\\",\\"dateModified\\":\\"2025-09-16T07:24:20.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"GYQ\\",\\"url\\":\\"https://github.com/Summer536\\"}]}"],["meta",{"property":"og:url","content":"https://your-domain.com/Notes/zh/posts/interview1.html"}],["meta",{"property":"og:site_name","content":"GYQ的博客"}],["meta",{"property":"og:title","content":"八股面试"}],["meta",{"property":"og:description","content":"简介 记录一些面试问题。"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-09-16T07:24:20.000Z"}],["meta",{"property":"article:tag","content":"八股面试"}],["meta",{"property":"article:published_time","content":"2025-06-03T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-09-16T07:24:20.000Z"}]]},"git":{"createdTime":1748915646000,"updatedTime":1758007460000,"contributors":[{"name":"yqgao","username":"yqgao","email":"gaoyuqing536@gmail.com","commits":3,"url":"https://github.com/yqgao"}]},"readingTime":{"minutes":4.47,"words":1340},"filePathRelative":"zh/posts/interview1.md","excerpt":"\\n<h2>简介</h2>\\n<p>记录一些面试问题。</p>\\n","autoDesc":true}')},6262:(e,a)=>{a.A=(e,a)=>{const t=e.__vccOpts||e;for(const[e,n]of a)t[e]=n;return t}}}]);